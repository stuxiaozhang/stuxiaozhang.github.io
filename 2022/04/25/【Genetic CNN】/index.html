<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;auto&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220330150132.png"><link rel="icon" href="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220330150132.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content="Genetic CNN
Genetic CNN 将遗传算法用于神经网络架构搜索，论文首先提出了一种能表示神经网络架构的编码方案，在此编码方案上初始化种群，对种群进行选择、变异、交叉，从而抛弃性能差的神经网络架构并产生新的神经网络架构，论文将训练好的架构在验证集上的准确率作为评判网络性能好坏的指标。
Basic Idea
核心思想是提出一种编码方法，用固定长度的二进制字符串表示每个网络结构。通"><meta name="author" content="小张同学"><meta name="keywords" content=""><title>【Genetic CNN】 - 小张同学的博客</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"stuxiaozhang.github.io",root:"/",version:"1.8.11",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},copy_btn:!0,image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:4},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:"81O1jSOqY3veRxOg71BDYfri-gzGzoHsz",app_key:"CgnvRL262D07ied40NiXm2VL",server_url:null}},search_path:"/local-search.xml"}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.3.0"></head><body><header style="height:50vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>xiaozhang's space</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/schedule/"><i class="iconfont icon-cliplist"></i> 动态</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner" id="banner" parallax="true" style="background:url(https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220330150632.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="【Genetic CNN】"></span><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> 小张同学 </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-04-25 13:23" pubdate>2022年4月25日</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 2.5k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 17 分钟 </span><span id="leancloud-page-views-container" class="post-meta" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="leancloud-page-views"></span> 次</span></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="d-none d-lg-block col-lg-1"></div><div class="col-lg-9 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">【Genetic CNN】</h1><p class="note note-info">本文最后更新于：2022年6月8日</p><div class="markdown-body"><h1 id="genetic-cnn">Genetic CNN</h1><p>Genetic CNN 将遗传算法用于神经网络架构搜索，论文首先提出了一种能表示神经网络架构的编码方案，在此编码方案上初始化种群，对种群进行选择、变异、交叉，从而抛弃性能差的神经网络架构并产生新的神经网络架构，论文将训练好的架构在验证集上的准确率作为评判网络性能好坏的指标。</p><h2 id="basic-idea">Basic Idea</h2><p>核心思想是提出一种编码方法，用固定长度的二进制字符串表示每个网络结构。通过生成一组随机个体来初始化遗传算法。在每一次生成中，定义标准的遗传操作，例如选择，变异和交叉，以产生有竞争能力的个体并消除弱势的个体。每个个体的（适应度函数）取决于参考数据集上的识别准确率。为此，对每个个体（即网络结构）执行独立于遗传算法的完整训练过程。在固定次数的迭代之后，遗传过程就结束了。</p><h2 id="background">Background</h2><p>传统的遗传算法往往具有下列步骤</p><ol type="1"><li>定义个体的基因编码方案</li><li>初始化种群</li><li>衡量个体生存竞争能力的适应度（通常是一个函数，函数值表示个体的生存竞争能力）</li><li>淘汰适应度低的个体，选择适应度高的个体构成种群下一代的成员（选择）</li><li>按一定概率对下一代成员进行基因的交叉与变异（交叉与变异），产生新个体的基因编码方案</li><li>评估新种群的适应度</li></ol><p>可以看到，遗传算法其实就是模仿生物进化的过程。</p><h2 id="method">Method</h2><h3 id="二进制网络表示">二进制网络表示</h3><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220422150322.png" srcset="/img/loading.gif" lazyload></p><p>许多常见的state-of-the-art神经网络架构都可以分为几个stage，两个stage之间通过池化操作连接，同个stage内的所有卷积操作都有相同的过滤器数目，基于上述观察，论文得出了神经网络架构的基因编码方案，具体如下：</p><ol type="1"><li>每个神经网络架构由S个阶段构成，阶段与阶段之间通过池化操作连接</li><li>每个阶段stage都有 <span class="math inline">\(K_s\)</span> 个节点组成，这 <span class="math inline">\(K_s\)</span> 个节点其实是卷积 + BN + ReLU的操作，<span class="math inline">\(K_s\)</span> 个节点编号并由小到大顺序排序</li><li>使用有向边连接一个阶段中的节点，每个节点只能连接比自己编号要大的节点，用 <span class="math inline">\(v_{s,k_s}\)</span> 表示第 <span class="math inline">\(s\)</span> 阶段的第 <span class="math inline">\(k_s\)</span> 个节点，其中 <span class="math inline">\(k_s=1,2...,K_S\)</span></li></ol><p>为了使每个二进制字符串有效，在每个阶段定义两个默认节点。<strong>默认输入节点</strong>（表示为 <span class="math inline">\(v_{s,0}\)</span>）从上一阶段接收数据，执行卷积并将其输出发送到每个节点，而无需前置节点（例如 <span class="math inline">\(v_{s,1}\)</span>）。<strong>默认输出节点</strong>（表示为 <span class="math inline">\(v_{s,K_s+1}\)</span>）从所有节点接收数据并对其求和，然后进行卷积，然后将其输出发送到池化层，同样也没有后继节点，例如 <span class="math inline">\(v_{s,K_s}\)</span>。注意，普通节点和默认节点之间的连接未被编码。</p><p><strong>有两种特殊情况</strong>。首先，如果一个普通节点 <span class="math inline">\(v_{s,i}\)</span> 是孤立的（即它没有连接到任何其他普通节点 <span class="math inline">\(v_{s,j},i \ne j\)</span>），那么它将被简单地忽略，即它没有连接到默认输入节点 也没有默认输出节点（请参见图1中的B2节点）。这是为了确保具有更多节点的阶段可以模拟由具有较少节点的阶段表示的所有结构。其次，如果某个阶段没有连接，即二进制字符串中的所有位均为0，则卷积运算仅执行一次，而不是执行两次（一个由默认输入节点执行，另一个由默认输出节点执行） 。</p><p>使用所提出的编码方案可以表示许多流行的网络结构。示例包括 VGGNet，ResNet 和 DenseNet 的改进版本，如图2所示。</p><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220424155115.png" srcset="/img/loading.gif" lazyload style="zoom:80%"></p><p>存在的局限性：</p><ul><li>当前，编码的结构仅涉及卷积和池化操作，无法生成某些棘手的网络模块，例如 Maxout。</li><li>卷积核的大小和通道的数量在每个阶段都是固定的，这限制了网络无法像初始模块一样合并多维度信息。</li></ul><h3 id="遗传操作">遗传操作</h3><p>遗传过程的流程图如算法1所示。该过程从具有N个随机个体的初始化种群开始。然后，执行T轮迭代代，每次迭代包括三个操作，即选择，突变和交叉。通过在参考数据集中进行从头训练来评估每个个体的性能。</p><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220422155522.png" srcset="/img/loading.gif" lazyload></p><h4 id="初始化种群">1 初始化种群</h4><p>初始化一个随机模型集合 <span class="math inline">\(\left\{\mathbb{M}_{0, n}\right\}_{n=1}^{N}\)</span>，每个模型是长度为L的二进制串，串上每位服从伯努利分布 <span class="math inline">\(b_{0,n}^l \sim \mathcal{B}(0.5), l=1,2,...,L\)</span>，然后训练并测试每个模型的准确率，这里<strong>不同的初始化策略不会对遗传性能产生太大影响</strong>。即使从最简单的初始化开始（所有个体都是零字符串），遗传过程仍可以通过交叉和突变发现相当有竞争性的结构。</p><h4 id="选择">2 选择</h4><p>在每一代种群生成前都会进行选择操作，在t-th代前，个体 <span class="math inline">\(\mathbb{M}_{t-1,n}\)</span> 的适应性为 <span class="math inline">\(r_{t-1,n}\)</span>，直接影响 <span class="math inline">\(\mathbb{M}_{t-1,n}\)</span> 在选择阶段存活的概率。具体选择使用俄罗斯轮盘选择法(Russian roulette)，每个个体选取的概率与 <span class="math inline">\(r_{t-1,n}-r_{t-1,0}\)</span> 成比例，<span class="math inline">\(r_{t-1,0}\)</span> 为上一代的最低适应性。选择后的保持种群总数不变，所以一个个体可能会被选择多次</p><h4 id="变异和交叉">3 变异和交叉</h4><p>单个 <span class="math inline">\(\mathbb M_{t,n}\)</span> 的变异的操作包含对二进制串每个位进行概率为 <span class="math inline">\(q_M\)</span> 的反转。在实验中，<span class="math inline">\(q_M\)</span> 通常很小，例如0.05，因此变异不太可能使一个个体改变太多。这是为了保留一个个体的良好信息，同时提供尝试新可能性的机会。</p><p>交叉过程涉及同时更改两个个体，每对阶段以很小的概率 <span class="math inline">\(q_C\)</span> 交换。<strong>交叉中的基本单元是一个阶段stage，而不是单独考虑每个位</strong>，这是由于需要将局部结构保留在每个阶段内。</p><h4 id="评价">4 评价</h4><p>在上述过程之后，对每个单独的 <span class="math inline">\(\mathbb M_{t,n}\)</span> 进行训练和测试来获得适应度函数值。如果先前对 <span class="math inline">\(\mathbb M_{t,n}\)</span> 进行过评估，只需再次对其进行评估，然后求所有发生次数的平均。这样减轻了训练过程中随机性引起的不稳定性。</p><h2 id="experiments">Experiments</h2><h3 id="mnist">MNIST</h3><ol type="1"><li><p>通过遗传操作，可以找到具有竞争力的网络结构，达到较高的精度。虽然在很短的时间内，最佳个体的识别率没有提高，但平均和中等准确率通常会随着代代而提高。这是非常重要的，因为它保证了遗传算法提高了个体的整体素质。</p></li><li>实验验证了：一个更好的个体更有可能通过变异或交叉产生一个好的个体。</li><li><p>做了对比试验不同初始化网络的影响。验证了不同的初始化策略不会对遗传性能产生太大影响。</p></li></ol><h3 id="cifar10">CIFAR10</h3><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220424151857.png" srcset="/img/loading.gif" lazyload></p><p>图5绘制了从两个单独的遗传过程中学习到的网络结构。通过遗传算法学习的结构与人工设计的结构有很大不同，尽管观察到一些人工设计的局部结构，如链状网络、多径网络和公路网络。我们强调这两个网络是通过独立的遗传过程获得的，这表明我们的遗传过程通常会收敛到类似的网络结构。</p><h3 id="svhn">SVHN</h3><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220424155207.png" srcset="/img/loading.gif" lazyload style="zoom:80%"></p><p>可以看到虽然GeNet（17层）的识别错误率较高，但是可以看到中使用的结构(后4个)都很深......由于密集连接通常不是最佳选择，作者认为可以使用遗传算法来优化网络中使用的连接 。</p><h2 id="summary">Summary</h2><p>本文将遗传算法应用于神经网络的结构设计。首先提出了一种编码方法，用固定长度的二进制字符串来表示每个网络结构，然后使用一些遗传操作，如变异和交叉，来有效地探索搜索空间（基本相当于只搜索节点间的连接方式=_=）。不同的初始化策略对遗传过程影响不大。使用一个相对较小的参考数据集（CIFAR10）进行遗传算法，发现生成的结构可以很好地转移到其他任务，包括大规模的ILSVRC2012数据集。</p><p>这样的编码形式可以编码目前的主流分类结构，但也有很多局限性：</p><ul><li>目前的连接方式只有卷积和池化，不能使用其它比较tricky的模块，例如Maxout。</li><li>每个阶段的卷积核是固定的，阻碍了multi-scale特征的融合。</li></ul><p>所以说最大的问题就是能生成这样类似的网络结构，但是参数是定死的，这样子就会失去它的灵活性，搜索出的网络结构比较局限。</p><p>在目前的工作中，遗传算法仅用于探索网络结构，而网络训练过程是单独进行的。未来工作可以将遗传算法结合起来同时训练网络结构和权重。</p></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/Papers/">Papers</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/tags/EANAS/">EANAS</a></div></div><p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处来源：<a href="https://stuxiaozhang.github.io/">小张的宇宙空间站</a></p><div class="post-prevnext"><article class="post-prev col-6"><a href="/2022/04/28/%E3%80%90CGP-CNN%E3%80%91A%20Genetic%20Programming%20Approach%20to%20Designing%20Convolutional%20Neural%20Network%20%20Architectures/"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">【CGP-CNN】A Genetic Programming Approach to Designing Convolutional Neural Network Architectures</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2022/04/23/%E6%A8%A1%E6%8B%9F%E5%93%88%E5%B8%8C%E8%A1%A8/"><span class="hidden-mobile">模拟哈希表</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments" lazyload><div id="valine"></div><script type="text/javascript">Fluid.utils.loadComments("#valine",function(){Fluid.utils.createScript("https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js",function(){var e=Object.assign({appId:"81O1jSOqY3veRxOg71BDYfri-gzGzoHsz",appKey:"CgnvRL262D07ied40NiXm2VL",placeholder:"快来评论鸭~",path:"window.location.pathname",avatar:"retro",meta:["nick","mail","link"],pageSize:10,lang:"zh-CN",highlight:!0,recordIP:!0,serverURLs:"",emojiCDN:"https://cdn.bootcdn.net/ajax/libs/emojione/4.5.0/lib/js/emojione.min.js",emojiMaps:null,enableQQ:!0,requiredFields:["nick"]},{el:"#valine",path:window.location.pathname});new Valine(e)})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"><a href="https://stuxiaozhang.github.io" target="_blank" rel="nofollow noopener"><span>小张同学的宇宙空间站</span></a> 已经运转了<span id="timeDate">载入天数...</span><script src="/js/duration.js"></script></div><div class="statistics"><span id="leancloud-site-pv-container" style="display:none">总访问量 <span id="leancloud-site-pv"></span> 次 </span><span id="leancloud-site-uv-container" style="display:none">总访客数 <span id="leancloud-site-uv"></span> 人</span></div></footer><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script><script src="/js/local-search.js"></script><script defer src="/js/leancloud.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js"></script><script>!function(t){(0,Fluid.plugins.typing)(t.getElementById("subtitle").title)}((window,document))</script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},options:{renderActions:{findScript:[10,a=>{document.querySelectorAll('script[type^="math/tex"]').forEach(e=>{var t=!!e.type.match(/; *mode=display/);const n=new a.options.MathItem(e.textContent,a.inputJax[0],t);t=document.createTextNode("");e.parentNode.replaceChild(t,e),n.start={node:t,delim:"",n:0},n.end={node:t,delim:"",n:0},a.math.push(n)})},"",!1],insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(e=>{let t=e.parentNode;"li"===t.nodeName.toLowerCase()&&t.parentNode.classList.add("has-jax")})},"",!1]}}}</script><script async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.4/es5/tex-svg.js"></script><script src="/js/boot.js"></script></body></html>