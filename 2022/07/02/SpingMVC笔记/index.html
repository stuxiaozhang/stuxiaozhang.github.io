<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;auto&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220330150132.png"><link rel="icon" href="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220330150132.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content="SpringMVC笔记
一、介绍

1、什么是SpringMVC
SpringMVC是基于Spring的MVC开发模式的一个框架，实际上就是spring的一个模块，专门是做web开发的，理解为servlet的升级。web开发底层是servlet，框架是在servlet基础上面加入一些功能，让开发更方便。
什么是MVC？
它是一种开发模式，它是模型视图控制器的简称。所有的web应用都是基"><meta name="author" content="小张同学"><meta name="keywords" content=""><title>SpingMVC笔记 - 小张同学的博客</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"stuxiaozhang.github.io",root:"/",version:"1.8.11",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},copy_btn:!0,image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:4},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:"81O1jSOqY3veRxOg71BDYfri-gzGzoHsz",app_key:"CgnvRL262D07ied40NiXm2VL",server_url:null}},search_path:"/local-search.xml"}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.3.0"></head><body><header style="height:50vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>xiaozhang's space</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/schedule/"><i class="iconfont icon-cliplist"></i> 动态</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner" id="banner" parallax="true" style="background:url(https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220330150632.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="SpingMVC笔记"></span><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> 小张同学 </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-07-02 18:51" pubdate>2022年7月2日</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 12.1k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 109 分钟 </span><span id="leancloud-page-views-container" class="post-meta" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="leancloud-page-views"></span> 次</span></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="d-none d-lg-block col-lg-1"></div><div class="col-lg-9 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">SpingMVC笔记</h1><p class="note note-info">本文最后更新于：2022年7月11日</p><div class="markdown-body"><h1 id="springmvc笔记">SpringMVC笔记</h1><h1 id="一介绍">一、介绍</h1><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711192028.png" srcset="/img/loading.gif" lazyload></p><h2 id="什么是springmvc">1、什么是SpringMVC</h2><p>SpringMVC是基于Spring的MVC开发模式的一个框架，实际上就是spring的一个模块，专门是做web开发的，理解为servlet的升级。web开发底层是servlet，框架是在servlet基础上面加入一些功能，让开发更方便。</p><h3 id="什么是mvc">什么是MVC？</h3><p>它是一种开发模式，它是模型视图控制器的简称。所有的web应用都是基于MVC开发。</p><ul><li><p>M：模型层，包含实体类，业务逻辑层，数据访问层</p></li><li><p>V：视图层，html，javaScript，vue等都是视图层，用来显现数据</p></li><li><p>C：控制器，它是用来接收客户端的请求，并返回响应到客户端的组件，Servlet就是组件</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711192904.png" srcset="/img/loading.gif" lazyload></p><h3 id="spring和springmvc对比">Spring和SpringMVC对比</h3><ul><li><p>Spring：Spring是容器，ioc能够管理对象， 使用 <code>&lt; bean&gt;</code>，<code>@Component</code>，<code>@Repository</code>，<code>@Service</code>，<code>@Controller</code> 标签</p></li><li><p>SpringMVC：能够创建对象，放入到容器中（springmvc容器），spring容器中放的是控制器对象</p></li></ul><h3 id="springmvc简要流程">SpringMVC简要流程</h3><p>我们要做的是 <strong>使用 <span class="citation" data-cites="Controller">@Controller</span> 创建控制器对象</strong> ，把对象放入到 SpringMVC容器中，把创建的对象作为控制器使用。这个控制器对象能够接收用户的请求，显示处理结果，就当作是一个servlet使用。</p><p><strong>使用 <span class="citation" data-cites="Controller">@Controller</span> 注解创建的是一个普通的对象</strong> ，不是servlet，SpringMVC 赋予了控制器对象一些额外的功能。</p><blockquote><p>控制器对象他是一个被 SpringMVC 作为控制器, 功能和servlet一样的普通类对象。</p></blockquote><p>web开发底层是servlet，SpringMVC 中有一个对象是servlet：DispatcherServlet（中央调度器）</p><p>DispatcherServlet：负责接收用户的所有请求，用户把请求给了DispatcherServlet，之后DispatcherServlet把请求转发给我们的Controller对象，最后Controller对象处理请求。</p><h2 id="开发步骤">2、开发步骤</h2><p>index.jsp —&gt; DispatcherServlet（中央调度器，类似servlet） ----&gt; 转发，分配给Controller对象（<span class="citation" data-cites="Controller">@Controller</span> 注解创建的对象）</p><p><strong>需求</strong>：用户在页面发起一个请求，请求交给springmvc的控制器对象，并显示请求的处理结果</p><p><strong>实现步骤：</strong></p><ol type="1"><li><p>新建web maven工程</p></li><li><p>加入依赖，spring-webmvc依赖，间接把spring的依赖加入到项目中，jsp，servlet依赖</p></li><li><p>重点：在web.xml中注册springmvc框架的核心对象 DispatcherServlet</p><ol type="1"><li>DispatcherServlet叫做：中央调度器，是一个servlet，他的父类继承 HttpServlet</li><li>DispatcherServlet也叫做：前端控制器（from controller）</li><li>DispatcherServlet：负责接收用户提交的请求，调用其他控制器对象，并把请求的处理结果显示给用户</li></ol></li><li><p>创建一个发起请求的页面 index.jsp</p></li><li><p>创建控制器(处理器)类</p><ol type="1"><li><p>在类的上面加入@Controller注解，创建对象，并放到springmvc容器中</p><ol start="2" type="1"><li>在类中的方法上面加入@RequestMapping注解</li></ol></li></ol></li><li>创建一个作为结果的jsp，显示请求的处理结果。</li><li>创建springmvc的配置文件（和spring的配置文件一样）<ol type="1"><li>声明组件扫描器，指定@Controller注解所在的包名</li><li>声明视图解析器，帮助处理视图</li></ol></li></ol><p>启动Tomcat后，Tomcat扫描xml文件创建DispatcherServlet，DispatcherServlet在初始化的时候会加载mvc配置文件，创建springmvc容器，controller对象在容器中。*.do方法由中央调度器拿过来根据名字从springmvc容器中找到跟RequestMapping（values）对应的名称调用他的方法。</p><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711192935.png" srcset="/img/loading.gif" lazyload></p><h3 id="springmvc-开发流程">springmvc 开发流程：</h3><ul><li>发起some.do请求</li><li>tomcat ( <code>web.xml</code> 从 url-pattern 知道 <code>*.do</code> 的请求给 DispatcherServlet)</li><li>DispatcherServlet（根据 <code>springmvc.xml</code> 配置知道 <code>some.do</code>，<code>doSome()</code> 方法）</li><li>DispatcherServlet把 <code>some.do</code> 转发给 <code>MyController.doSome()</code> 方法</li><li>框架执行 <code>doSome()</code> 把得到的 <code>ModelAndView</code> 进行处理，转发到show.jsp</li></ul><p>发送some.do请求的页面 index.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;<br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>第一个springmvc项目<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;some.do&quot;</span>&gt;</span>发起some.do请求<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>核心配置文件 web.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;4.0&quot;</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!--声明：注册springmvc的核心对象DispatcherServlet</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">        需要在tomcat服务器启动后，创建DispatcherServlet对象实例</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">        为什么要创建DispatcherServlet对象的实例呢？</span><br><span class="hljs-comment">        	因为在DispatcherServlet创建过程中，会同时创建springmvc容器对象，</span><br><span class="hljs-comment">        	读取springmvc的配置文件，把这个配置文件中的对象都配置好，</span><br><span class="hljs-comment">        	当用户发起请求时就可以直接使用对象了。</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">        servlet的初始化会执行init()方法，DispatcherServlet在init()中&#123;</span><br><span class="hljs-comment">            //创建容器，读取配置文件</span><br><span class="hljs-comment">            webApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;springmvc.xml&quot;);</span><br><span class="hljs-comment">            //把容器对象放入到ServletContext中</span><br><span class="hljs-comment">            getServletContext().setAttribute(key,ctx);</span><br><span class="hljs-comment">         &#125;</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!--自定义springmvc读取文件的位置--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--springmvc配置文件的位置属性--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--指定自定义文件的位置--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!--表示在tomcat启动后，创建servlet对象</span><br><span class="hljs-comment">            数字表示启动后创建对象的顺序，数值越小，tomcat创建对象越早，要求大于等于0的整数</span><br><span class="hljs-comment">        --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">load-on-startup</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">load-on-startup</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">                使用框架的时候，url-pattern可以使用两种值</span><br><span class="hljs-comment">                1.使用扩展名方式，语法 *.xxxx , xxxx时自定义扩展名。常用的方式 *.do, *.action, *.mvc等等</span><br><span class="hljs-comment">                    http://localhost:8080/myweb/some.do</span><br><span class="hljs-comment">                    http://localhost:8080?myweb/other.do</span><br><span class="hljs-comment">                2.使用斜杠&quot;/&quot;</span><br><span class="hljs-comment">            --&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>*.do<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure><p>tomcat启动，创建DispatcherServlet对象，同时创建springmvc容器对象，读取springmvc配置文件， 这里配置文件的根地址 classpath = springmvc.xml</p><p>在 springmvc.xml中声明 <strong>组件扫描器</strong> 和 <strong>视图解析器</strong></p><p><em>springmvc.xml</em></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans </span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd </span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/context </span></span><br><span class="hljs-tag"><span class="hljs-string">       https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--声明组件扫描器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.zh.controller&quot;</span>/&gt;</span><br>    <br>     <span class="hljs-comment">&lt;!--声明 springmvc框架中的视图解析器，帮助开发人员设置视图文件的路径--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--前缀：视图文件位置--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;prefix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;/WEB-INF/view/&quot;</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!--后缀：视图文件的扩展名--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;suffix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;.jsp&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>创建控制器类 <em>MyController.java</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.zh.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">* @Controller：创建处理器对象，对象放在springmvc容器中</span><br><span class="hljs-comment">*</span><br><span class="hljs-comment">* 能处理请求的都是控制器（处理器）：MyController能处理请求，</span><br><span class="hljs-comment">*                               叫做后端控制器（back controller）</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyController</span> </span>&#123;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    * 处理用户提交的请求，springmvc中是使用方法来处理的。</span><br><span class="hljs-comment">    * 方法是自定义的，可以有多种返回值，多种参数，方法名称自定义</span><br><span class="hljs-comment">    * */</span><br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    * 准备使用doSome方法处理some.do请求。</span><br><span class="hljs-comment">    * @RequestMapping：请求映射，作用是把一个请求地址和一个方法绑定在一起。</span><br><span class="hljs-comment">    *                  一个请求指定一个方法处理。</span><br><span class="hljs-comment">    *             属性：1. value是一个String类型，表示请求的uri地址（这里是：some.do）</span><br><span class="hljs-comment">    *                     value值是唯一的，不能重复</span><br><span class="hljs-comment">    *             说明：使用@RequestMapping修饰的方法叫做处理器方法或者控制器方法</span><br><span class="hljs-comment">    *                   可以处理请求，类似servlet中的doGet,doPost</span><br><span class="hljs-comment">    * */</span><br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    * 返回值 ModelAndView 表示本次请求的处理结果</span><br><span class="hljs-comment">    *   model:数据，请求处理完后，要显示给用户的数据</span><br><span class="hljs-comment">    *   view：视图，比如jsp等</span><br><span class="hljs-comment">    * */</span><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/some.do&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doSome</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-comment">//处理some.do请求，相当于service调用处理完成了</span><br>        ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>        <span class="hljs-comment">//添加数据，框架在请求的最后把数据放入到request作用域</span><br>        <span class="hljs-comment">//request.setAttribute(&quot;msg&quot;,&quot;欢迎使用....&quot;);</span><br>        mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;欢迎使用springmvc做web开发&quot;</span>);<br>        mv.addObject(<span class="hljs-string">&quot;fun&quot;</span>,<span class="hljs-string">&quot;执行的是doSome方法&quot;</span>);<br><br>        <span class="hljs-comment">//指定视图，指定视图的完整路径</span><br>        <span class="hljs-comment">//框架对视图执行的forward操作，request.getRequestDispather(&quot;/show.jsp&quot;).forward(...)</span><br>        mv.setViewName(<span class="hljs-string">&quot;/show.jsp&quot;</span>);<br>        <span class="hljs-keyword">return</span> mv;<br>    &#125;<br>    <br>    <br>    <span class="hljs-comment">//在springmvc.xml配置视图解析器后，修改 setViewName()</span><br>    <span class="hljs-meta">@RequestMapping(value = &#123;&quot;/other.do&quot;,&quot;/second.do&quot;&#125;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doOther</span><span class="hljs-params">()</span></span>&#123;<br>        ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>        mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;---------欢迎使用springmvc做web开发----------&quot;</span>);<br>        mv.addObject(<span class="hljs-string">&quot;fun&quot;</span>,<span class="hljs-string">&quot;执行的是doOther方法&quot;</span>);<br>        <br>        <span class="hljs-comment">//当配置了视图解析器后，可以使用逻辑名称（文件名），指定视图</span><br>        <span class="hljs-comment">//框架会使用视图解析器的 前缀 + 逻辑名称 +后缀 组成完整路径</span><br>        mv.setViewName(<span class="hljs-string">&quot;other&quot;</span>);<br>        <span class="hljs-keyword">return</span> mv;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>对应的 <em>show.jsp</em></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;<br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>show.jsp从request作用域获取数据<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>msg数据:$&#123;msg&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>fun数据:$&#123;fun&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="spirngmvc执行流程">SpirngMVC执行流程</h2><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711192949.png" srcset="/img/loading.gif" lazyload></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">ApplicationContext ctx = <span class="hljs-keyword">new</span> ClassPathXmlApplication(<span class="hljs-string">&quot;bean.xml&quot;</span>);<br>StudentService service = (StudentService)ctx.getBean(<span class="hljs-string">&quot;service&quot;</span>);<br></code></pre></td></tr></table></figure><p>SpringMVC内部请求的处理流程：也就是SpringMVC接收请求，到处理完成的过程</p><ol type="1"><li><p>用户发起请求 some.do</p></li><li><p>DispatcherServlet 接收请求 some.do，把请求转交给处理器映射器</p><ul><li><p>处理器映射器：SpringMVC框架中的一种对象，框架把实现了 HandlerMapping 接口的类都叫做映射器（多个）</p></li><li>处理器映射器的作用：根据请求，从SpringMVC容器对象中获取处理器对象 <code>MyController controller = ctx.getBean(&quot;some.do&quot;)</code>。框架把找到的处理器对象放到一个叫做处理器执行链 <code>HandlerExecutionChain</code> 的类保存。</li><li><code>HandlerExecutionChain</code>：<ol type="1"><li>处理器对象 <code>MyController</code></li><li>项目中的所有的拦截器 <code>List&lt;HandlerInterceptor&gt; inerceptorList</code></li></ol></li></ul></li><li><p>DispatcherServlet 把2中的 <code>HandlerExecutionChain</code> 中的处理器对象交给了处理器适配器对象（多个）</p><ul><li>处理器适配器：SpringMVC框架中的对象，需要实现 <code>HandlerAdapter</code> 接口。</li><li>处理器适配器的作用：执行处理器方法（调用 <code>MyController.doSome()</code> 得到返回值 <code>ModelAndView</code> ）</li></ul></li><li><p>DispatcherServlet 把3中的 <code>ModelAndView</code> 交给了视图解析器对象。</p><ul><li><p>视图解析器：SpringMVC框架中的对象，需要实现 <code>ViewResolver</code> 接口（可以有多个）</p></li><li><p>视图解析器的作用：组成视图完整路径，使用前缀，后缀。并创建View对象。</p><p>View是一个接口，表示视图的，在框架中jsp，html不是string表示，而是使用View和他的实现类表示视图。</p><p><code>InternalResourceView</code>：视图类，表示jsp文件，视图解析器会创建 <code>InternalResourceView</code> 类对象。这个对象的里面，有一个属性 <code>url=/WEB-INF/view/show.jsp</code></p></li></ul></li><li><p>DispatcherServlet 把4中的创建的View对象获取到，调用View类自己的方法，把Model数据放入到 request 作用域。执行对象视图的 forward。请求结束。</p></li></ol><h1 id="二springmvc注解式开发">二、SpringMVC注解式开发</h1><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193110.png" srcset="/img/loading.gif" lazyload></p><h2 id="requestmapping-定义请求规则">1、<span class="citation" data-cites="RequestMapping">@RequestMapping</span> 定义请求规则</h2><h3 id="value属性指定模块名称">value属性：指定模块名称</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">* @RequestMapping</span><br><span class="hljs-comment">* 	value:所有请求的公共部分，叫做模块名称</span><br><span class="hljs-comment">*   位置：在类的上面</span><br><span class="hljs-comment">* */</span><br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;/user&quot;)</span><br><span class="hljs-comment">//或者@RequestMapping(&quot;/test&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyController</span> </span>&#123;<br><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/some.do&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doSome</span><span class="hljs-params">()</span></span>&#123;<br>        ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>        mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;欢迎使用springmvc做web开发&quot;</span>);<br>        mv.addObject(<span class="hljs-string">&quot;fun&quot;</span>,<span class="hljs-string">&quot;执行的是doSome方法&quot;</span>);<br>        mv.setViewName(<span class="hljs-string">&quot;show&quot;</span>);<br>        <span class="hljs-keyword">return</span> mv;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>理解为在该方法在 user或者test模块下</p><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193135.png" srcset="/img/loading.gif" lazyload style="zoom:33%"></p><h3 id="method属性指定请求方式">method属性：指定请求方式</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;/test&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyController</span> </span>&#123;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    * @RequestMapping(value = &quot;&quot;,method = )</span><br><span class="hljs-comment">    * 	属性：method 表示请求的方式，它的值是RequestMethod类枚举值</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * 	get请求方式， method = RequestMethod.GET</span><br><span class="hljs-comment">    * 	post请求方式，method = RequestMethod.POST</span><br><span class="hljs-comment">    * </span><br><span class="hljs-comment">    * */</span><br><br>    <span class="hljs-comment">//指定some.do用get请求获取</span><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/some.do&quot;,method = RequestMethod.GET)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doSome</span><span class="hljs-params">()</span></span>&#123;<br>        ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>        mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;欢迎使用springmvc做web开发&quot;</span>);<br>        mv.addObject(<span class="hljs-string">&quot;fun&quot;</span>,<span class="hljs-string">&quot;执行的是doSome方法&quot;</span>);<br>        mv.setViewName(<span class="hljs-string">&quot;show&quot;</span>);<br>        <span class="hljs-keyword">return</span> mv;<br>    &#125;<br><br>    <span class="hljs-comment">//指定other.do 用post请求获取</span><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/other.do&quot;,method = RequestMethod.POST)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doOther</span><span class="hljs-params">()</span></span>&#123;<br>        ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>        mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;---------欢迎使用springmvc做web开发----------&quot;</span>);<br>        mv.addObject(<span class="hljs-string">&quot;fun&quot;</span>,<span class="hljs-string">&quot;执行的是doOther方法&quot;</span>);<br>        mv.setViewName(<span class="hljs-string">&quot;other&quot;</span>);<br>        <span class="hljs-keyword">return</span> mv;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> %&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;title&gt;Title&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>    &lt;p&gt;第一个springmvc项目&lt;/p&gt;<br>    &lt;p&gt;&lt;a href=&quot;test/some.do&quot;&gt;发起some.do的get请求&lt;/a&gt;&lt;/p&gt;<br><br>    &lt;form action=<span class="hljs-string">&quot;test/other.do&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>        &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;post请求other.do&quot;</span>&gt;<br>    &lt;/form&gt;<br>    <br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><h2 id="处理器方法的参数">2、处理器方法的参数</h2><p>处理器方法可以包含以下四类参数，这些参数会在系统调用时由系统自动赋值，即程序员可以在方法中直接使用。</p><ol type="1"><li>HttpServletRequest 请求</li><li>HttpServletResponse 应答</li><li>HttpSession 会话</li><li>请求中所携带的请求参数</li></ol><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193257.png" srcset="/img/loading.gif" lazyload></p><h3 id="前三类参数使用方式">1. 前三类参数使用方式</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyController</span> </span>&#123;<br>    <span class="hljs-meta">@RequestMapping(value = &quot;/other.do&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doOther</span><span class="hljs-params">(HttpServletRequest request,</span></span><br><span class="hljs-function"><span class="hljs-params">                               HttpServletResponse response,</span></span><br><span class="hljs-function"><span class="hljs-params">                               HttpSession session)</span> </span>&#123;<br>        ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>        mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>, <span class="hljs-string">&quot;====欢迎使用springmvc开发===：&quot;</span> + request.getParameter(<span class="hljs-string">&quot;name&quot;</span>));<br>        mv.addObject(<span class="hljs-string">&quot;fun&quot;</span>, <span class="hljs-string">&quot;执行的是doOther方法&quot;</span>);<br>        mv.setViewName(<span class="hljs-string">&quot;other&quot;</span>);<br><br>        <span class="hljs-keyword">return</span> mv;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193316.png" srcset="/img/loading.gif" lazyload></p><h3 id="逐个参数接收">2. 逐个参数接收</h3><p>接收用户提交的参数：<strong>处理器（控制器）方法的形参名和请求中的参数必须一致</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyController</span> </span>&#123;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    * 逐个接收请求参数：</span><br><span class="hljs-comment">    *   要求：处理器（控制器）方法的形参名和请求中的参数必须一致</span><br><span class="hljs-comment">    *         同名的请求参数赋值给同名的参数</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * 框架接收请求参数：</span><br><span class="hljs-comment">    * 1 使用request对象接收请求参数</span><br><span class="hljs-comment">    *   String strName = request.getParameter(&quot;name&quot;);</span><br><span class="hljs-comment">    *   String strAge = request.getParameter(&quot;age&quot;);</span><br><span class="hljs-comment">    * 2 springmvc框架通过dispatcherServlet 调用MyController的doSome方法</span><br><span class="hljs-comment">    *   调用方法时，按名称对应，把接收的参数赋值给形参 doSome(strName,Integer.valueOf(strAge))</span><br><span class="hljs-comment">    *   框架会提供类型转换的功能，把String转换为 int ，long ，float ，double等</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * */</span><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/some.do&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doSome</span><span class="hljs-params">(String name,Integer age)</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;dosome方法的，name=&quot;</span>+name+<span class="hljs-string">&quot;, age=&quot;</span>+age);<br><br>        ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>        mv.addObject(<span class="hljs-string">&quot;myname&quot;</span>,name);<br>        mv.addObject(<span class="hljs-string">&quot;myage&quot;</span>,age);<br>        mv.setViewName(<span class="hljs-string">&quot;show&quot;</span>);<br>        <span class="hljs-keyword">return</span> mv;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> %&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;title&gt;Title&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;p&gt;提交参数给Controller&lt;/p&gt;<br><br>&lt;form action=<span class="hljs-string">&quot;some.do&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>    姓名：&lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;name&quot;</span>&gt;&lt;br/&gt;<br>    年龄：&lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;age&quot;</span>&gt;&lt;br/&gt;<br>    &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;提交参数&quot;</span>&gt;<br>&lt;/form&gt;<br><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><h3 id="请求参数中文乱码问题">3. 请求参数中文乱码问题</h3><p>注意：在提交请求参数的时候，get请求方式中文没有乱码；<strong>post请求方式中文有乱码</strong>，需要使用<strong>过滤器 CharacterEncodingFilter</strong> 处理乱码问题。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs xml">//在web.xml配置过滤器<br><span class="hljs-comment">&lt;!--注册声明过滤器，解决post请求乱码的问题--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>characterEncodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--设置项目中使用的字符编码--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>encoding<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>utf-8<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--强制请求对象（HttpServletRequest）使用encoding编码的值--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>forceRequestEncoding<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--强制应答对象（HttpServletResponse）--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>forceResponseEncoding<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>characterEncodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">    /*  : 表示强制所有的请求先通过过滤器处理</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/rl-pattern&gt;<br><span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br></code></pre></td></tr></table></figure><p>补充：springMVC 中的 M-model，V-view，C-controller</p><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193324.png" srcset="/img/loading.gif" lazyload style="zoom:50%"></p><h3 id="校正请求参数名requestparam">4. 校正请求参数名@RequestParam</h3><p><strong>请求参数名和处理器方法的形参名不一样，使用 <span class="citation" data-cites="RequestParam">@RequestParam</span> 注解</strong>（在处理方法参数前）</p><p>首页 index.jsp 的参数名是 iname 和 iage</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;p&gt;请求参数名和处理器方法的形参名不一样&lt;/p&gt;<br>&lt;form action=<span class="hljs-string">&quot;receiveparam.do&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>    姓名：&lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;iname&quot;</span>&gt;&lt;br/&gt;<br>    年龄：&lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;iage&quot;</span>&gt;&lt;br/&gt;<br>    &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;提交参数&quot;</span>&gt;<br>&lt;/form&gt;<br></code></pre></td></tr></table></figure><p>控制器方法的 doOther 方法形参为 name 和 age</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">* 请求参数名和处理器方法的形参名不一样</span><br><span class="hljs-comment">* @RequestParam：定义在处理器方法的形参前面</span><br><span class="hljs-comment">*   属性：1. value，请求参数名，可省略</span><br><span class="hljs-comment">*        2. required，是一个Boolean类型，默认为true，表示必须包含参数</span><br><span class="hljs-comment">* */</span><br><span class="hljs-meta">@RequestMapping(value = &quot;/receiveparam.do&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doOther</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;iname&quot;)</span> String name,</span></span><br><span class="hljs-function"><span class="hljs-params">                            <span class="hljs-meta">@RequestParam(&quot;iage&quot;)</span> Integer age)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;doOther方法的，name=&quot;</span>+name+<span class="hljs-string">&quot;, age=&quot;</span>+age);<br><br>    ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>    mv.addObject(<span class="hljs-string">&quot;myname&quot;</span>,name);<br>    mv.addObject(<span class="hljs-string">&quot;myage&quot;</span>,age);<br>    mv.setViewName(<span class="hljs-string">&quot;show&quot;</span>);<br>    <span class="hljs-keyword">return</span> mv;<br>&#125;<br></code></pre></td></tr></table></figure><p>此时将@RequestParam标签的属性required改为 fslse，不用参数也可以显示show.jsp。 当然我们希望required=true，作为前端限制。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doOther</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;iname&quot;,required = false)</span> String name,</span></span><br><span class="hljs-function"><span class="hljs-params">                            <span class="hljs-meta">@RequestParam(value = &quot;iage&quot;,required = false)</span> Integer age)</span></span>&#123;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193510.png" srcset="/img/loading.gif" lazyload></p><h3 id="对象参数接收">5. 对象参数接收</h3><p>将处理器方法的参数定义为一个对象，<strong>对象的属性名要求和请求中参数名一致</strong></p><p>先在vo包下定义一个Student 类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.bjpowernode.vo;<br><br><span class="hljs-comment">//保存请求参数值的普通类</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> </span>&#123;<br>    <span class="hljs-comment">//属性值要和请求参数值一样</span><br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Student</span><span class="hljs-params">()</span> </span>&#123; System.out.println(<span class="hljs-string">&quot;---------Student的无参构造方法--------&quot;</span>); &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;setName:&quot;</span> + name);<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getAge</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> age)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;setAge:&quot;</span>+age);<br>        <span class="hljs-keyword">this</span>.age = age;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Student&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;name=&#x27;&quot;</span> + name + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, age=&quot;</span> + age +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>主页index.jsp</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;p&gt;使用java对象接收参数&lt;/p&gt;<br>&lt;form action=<span class="hljs-string">&quot;object.do&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>    姓名：&lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;name&quot;</span>&gt;&lt;br/&gt;<br>    年龄：&lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;age&quot;</span>&gt;&lt;br/&gt;<br>    &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;提交参数&quot;</span>&gt;<br>&lt;/form&gt;<br></code></pre></td></tr></table></figure><p>处理器方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/object.do&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">receiveParam</span><span class="hljs-params">(Student std)</span> </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;receiveParam, name=&quot;</span> + std.getName() + <span class="hljs-string">&quot; age=&quot;</span> + std.getAge());<br>    ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>    mv.addObject(<span class="hljs-string">&quot;myname&quot;</span>, std.getName());<br>    mv.addObject(<span class="hljs-string">&quot;myage&quot;</span>, std.getAge());<br>    mv.addObject(<span class="hljs-string">&quot;mystudent&quot;</span>, std);<br><br>    mv.setViewName(<span class="hljs-string">&quot;show&quot;</span>);<br>    <span class="hljs-keyword">return</span> mv;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193621.png" srcset="/img/loading.gif" lazyload></p><p>后台结果</p><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193629.png" srcset="/img/loading.gif" lazyload></p><h2 id="处理器方法的返回值">3、处理器方法的返回值</h2><p>使用@Controller注解的处理器的处理器方法，其返回值常用的有4种类型：</p><ol type="1"><li>ModelAndView</li><li>String</li><li>void</li><li>自定义类型对象</li></ol><p>根据不同的情况，使用不同的返回值。</p><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193635.png" srcset="/img/loading.gif" lazyload></p><h3 id="返回modelandview">1. 返回ModelAndView</h3><p>若处理器方法处理完后，需要跳转到其他资源，且又要在跳转的资源间传递数据，此时处理器方法返回 ModelAndView 比较好。当然，若要返回 ModelAndView，则处理器方法中需要定义 ModelAndView对象。</p><p>在使用时，若该处理器方法只是进行跳转而不传递数据，或只是传递数据而不向任何资源跳转（如对页面的Ajax异步响应），此时若返回ModelAndView，则将总是有一部分多余，要么Model多余，要么View多余。即此时返回将不合适。</p><h3 id="返回string">2. 返回String</h3><p>String返回值可以表示逻辑视图名称或完整视图路径。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyController</span> </span>&#123;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    * 处理器方法返回String,表示逻辑视图名称，需要配置视图解析</span><br><span class="hljs-comment">    * */</span><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/returnString-view.do&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">doReturnView</span><span class="hljs-params">(HttpServletRequest request,String name, Integer age)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;dosome方法的，name=&quot;</span> + name + <span class="hljs-string">&quot;, age=&quot;</span> + age);<br><br>        <span class="hljs-comment">//手动添加数据到request作用域</span><br>        request.setAttribute(<span class="hljs-string">&quot;myname&quot;</span>,name);<br>        request.setAttribute(<span class="hljs-string">&quot;myage&quot;</span>,age);<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        * show：逻辑视图名称</span><br><span class="hljs-comment">        * 框架对视图执行forward转发操作</span><br><span class="hljs-comment">        * */</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;show&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//处理器方法返回 String，表示完整视图路径，此时不能配置视图解析器</span><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/returnString-view2.do&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">doReturnView2</span><span class="hljs-params">(HttpServletRequest request,String name, Integer age)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;---doReturnView2方法---，name=&quot;</span> + name + <span class="hljs-string">&quot;, age=&quot;</span> + age);<br><br>        <span class="hljs-comment">//手动添加数据到request作用域</span><br>        request.setAttribute(<span class="hljs-string">&quot;myname&quot;</span>,name);<br>        request.setAttribute(<span class="hljs-string">&quot;myage&quot;</span>,age);<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">         * 完整视图路径，项目中不能配置视图解析器</span><br><span class="hljs-comment">         * 框架对视图执行forward转发操作</span><br><span class="hljs-comment">         * */</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;WEB-INF/view/show.jsp&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>我整理：</p><ol type="1"><li><p>要么声明视图解析器</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--前缀：视图文件的路径--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;prefix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;/WEB-INF/view/&quot;</span> /&gt;</span><br>    <span class="hljs-comment">&lt;!--后缀：视图文件的扩展名--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;suffix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;.jsp&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure><p>然后控制器方法就可以写：<code>return &quot;show&quot;;</code></p></li><li><p>要么写完整路径即可。（无需视图解析器）直接：<code>return &quot;WEB-INF/view/show.jsp&quot;;</code></p></li></ol><h3 id="返回void">3. 返回void</h3><p>void：不能表示数据，也不能表示视图。</p><p>对于处理器方法返回 void 的应用场景，AJAX 响应.</p><p>若处理器对请求处理后，无需跳转到其它任何资源，此时可以让处理器方法返回 void。通过HttpServletResponse输出数据响应ajax请求。<strong>ajax请求服务器端返回的就是数据，和视图无关。</strong></p><p>Step1：maven 加入 jackson 依赖 由于本项目中服务端向浏览器传回的是 JSON 数据，需要使用一个工具类将字符串包装为 JSON 格式，所以需要导入 JSON 的依赖。</p><p>Step2：引入 jQuery 库 由于本项目要使用 jQuery 的 ajax()方法提交 AJAX 请求，所以项目中需要引入 jQuery 的库。在 WebRoot 下新建一个 Folder（文件夹），命名为 js，并将 jquery-3.4.1.js 文件放入其中。</p><p>当然，该 jQuery 库文件，需要在使用 ajax()方法的 index 页面中引入。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script type=<span class="hljs-string">&quot;text/javascript&quot;</span> src=<span class="hljs-string">&quot;js/jquery-3.4.1.js&quot;</span>&gt;&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>Step3：定义 index 页面 index 页面由两部分内容构成：一个是<code>&lt;button/&gt;</code>，用于提交 AJAX 请求；一个是<code>&lt;script/&gt;</code>，用于处理 AJAX 请求。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script type=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;<br>    $(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    $(<span class="hljs-string">&quot;button&quot;</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-comment">//alert(&quot;button click&quot;);</span><br>        $.ajax(&#123;<br>            <span class="hljs-comment">//url:&quot;returnVoid-ajax.do&quot;,</span><br>            <span class="hljs-comment">//url:&quot;returnStudentJsonArray.do&quot;,</span><br>            url:<span class="hljs-string">&quot;returnStringData.do&quot;</span>,<br>            data:&#123;<br>                name:<span class="hljs-string">&quot;zhangsan&quot;</span>,<br>                age:<span class="hljs-number">20</span><br>            &#125;,<br>            type:<span class="hljs-string">&quot;post&quot;</span>,<br>            dataType:<span class="hljs-string">&quot;text&quot;</span>,<br>            <span class="hljs-comment">//dataType:&quot;json&quot;,</span><br>            success:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resp</span>)</span>&#123;<br>                <span class="hljs-comment">//resp从服务器端返回的是json格式的字符串 &#123;&quot;name&quot;:&quot;zhangsan&quot;,&quot;age&quot;:20&#125;</span><br>                <span class="hljs-comment">//jquery会把字符串转为json对象， 赋值给resp形参。</span><br><br>                <span class="hljs-comment">// [&#123;&quot;name&quot;:&quot;李四同学&quot;,&quot;age&quot;:20&#125;,&#123;&quot;name&quot;:&quot;张三&quot;,&quot;age&quot;:28&#125;]</span><br>                <span class="hljs-comment">//alert(resp.name + &quot;    &quot;+resp.age);</span><br><br>                <span class="hljs-comment">/*$.each(resp,function(i,n)&#123;</span><br><span class="hljs-comment">                             alert(n.name+&quot;   &quot;+n.age)</span><br><span class="hljs-comment">                         &#125;)*/</span><br>                alert(<span class="hljs-string">&quot;返回的是文本数据：&quot;</span>+resp);<br><br>            &#125;<br>        &#125;)<br>    &#125;)<br>&#125;)<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>点击按钮发起请求</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;button id=&quot;btn&quot;&gt;发起ajax请求&lt;/button&gt;<br></code></pre></td></tr></table></figure><p>Step4: 定义对象 Student</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> </span>&#123;<br>    <span class="hljs-comment">// 属性名和请求中参数名一样</span><br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br></code></pre></td></tr></table></figure><p>Step5：修改处理器类 MyController 处理器对于 AJAX 请求中所提交的参数，可以使用逐个接收的方式，也可以以对象的方式整体接收。只要保证 AJAX 请求参数与接收的对象类型属性同名。 以逐个方式接收参数：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//处理器方法返回void， 响应ajax请求</span><br><span class="hljs-comment">//手工实现ajax，json数据： 代码有重复的 1. java对象转为json； 2. 通过HttpServletResponse输出json数据</span><br><br><span class="hljs-meta">@RequestMapping(value = &quot;/returnVoid-ajax.do&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doReturnVoidAjax</span><span class="hljs-params">(HttpServletResponse response, String name, Integer age)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;===doReturnVoidAjax====, name=&quot;</span> + name + <span class="hljs-string">&quot;   age=&quot;</span> + age);<br>    <span class="hljs-comment">//处理ajax， 使用json做数据的格式</span><br>    <span class="hljs-comment">//service调用完成了， 使用Student表示处理结果</span><br>    Student student  = <span class="hljs-keyword">new</span> Student();<br>    student.setName(<span class="hljs-string">&quot;张飞同学&quot;</span>);<br>    student.setAge(<span class="hljs-number">28</span>);<br><br>    String json = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-comment">//把结果的对象转为json格式的数据</span><br>    <span class="hljs-keyword">if</span>(student != <span class="hljs-keyword">null</span>)&#123;<br>        ObjectMapper om  = <span class="hljs-keyword">new</span> ObjectMapper();<br>        json  = om.writeValueAsString(student);<br>        System.out.println(<span class="hljs-string">&quot;student转换的json====&quot;</span>+json);<br>    &#125;<br><br>    <span class="hljs-comment">//输出数据，响应ajax的请求</span><br>    response.setContentType(<span class="hljs-string">&quot;application/json;charset=utf-8&quot;</span>);<br>    PrintWriter pw  = response.getWriter();<br>    pw.println(json);<br>    pw.flush();<br>    pw.close();<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="返回object">4. 返回Object</h3><p>处理器方法也可以返回 Object 对象。这个 Object 可以是 Integer，String，自定义对象，Map，List 等。对象有属性，属性就是数据。所以返回Object表示数据，和视图无关。即，返回的对象不是作为逻辑视图出现的，而是作为直接在页面显示的<strong>数据</strong>出现的。</p><p>返回对象，需要使用 <span class="citation" data-cites="ResponseBody">@ResponseBody</span> 注解，将转换后的 JSON 数据放入到响应体中。</p><p>现在做 ajax，主要使用 json的数据格式。 <strong>面试：springmvc开发中，返回值是object类型，如何转换为 json ？实现步骤</strong>：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs xml">1	加入处理json的工具库的依赖，springmvc默认使用的jackson<br><br>	pom.xml 加入jackson依赖<br><br>	<span class="hljs-comment">&lt;!--jackson依赖--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-databind<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>2	在springmvc配置文件之间加入 <span class="hljs-tag">&lt;<span class="hljs-name">mvc:annotation-driven</span>&gt;</span> 注解驱动<br>    <br>    主配置文件 springmvc.xml 加入：<br>    <br>    <span class="hljs-comment">&lt;!--@ResponseBody注解驱动--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mvc:annotation-driven</span>/&gt;</span><br>    <br>3	在处理器方法的上面加上 @ResponseBody<br></code></pre></td></tr></table></figure><p><strong>1）返回值是object类型，转换为 json</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">3</span>	在处理器方法的上面加上 <span class="hljs-meta">@ResponseBody</span><br>    <br>控制器方法 MyController.java<br><br><span class="hljs-comment">//处理器方法返回一个Student，通过框架转为json，响应ajax请求</span><br><span class="hljs-comment">//@ResponseBody 作用：把处理器方法返回对象转为json后，通过HttpServletResponse输出给浏览器</span><br><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-meta">@RequestMapping(value = &quot;returnStudentJson.do&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Student <span class="hljs-title">doStudentJsonObject</span><span class="hljs-params">(String name,Integer age)</span></span>&#123;<br><br>    Student student = <span class="hljs-keyword">new</span> Student();<br>    student.setName(<span class="hljs-string">&quot;lisi&quot;</span>);<br>    student.setAge(<span class="hljs-number">10</span>);<br>    <span class="hljs-keyword">return</span> student;  <span class="hljs-comment">// 会被框架转为json</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>2）当返回值是多个参数（用的比较普遍），返回类型改为List集合，其他不变</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(value =&quot;returnStudentJsonArray.do&quot; )</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Student&gt; <span class="hljs-title">doStudentJsonObjectArray</span><span class="hljs-params">(String name,Integer age)</span></span>&#123;<br><br>    List&lt;Student&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>    Student student = <span class="hljs-keyword">new</span> Student();<br>    student.setName(<span class="hljs-string">&quot;wangwu&quot;</span>);<br>    student.setAge(<span class="hljs-number">22</span>);<br>    list.add(student);<br><br>    student = <span class="hljs-keyword">new</span> Student();<br>    student.setName(<span class="hljs-string">&quot;tianmao&quot;</span>);<br>    student.setAge(<span class="hljs-number">10</span>);<br>    list.add(student);<br><br>    <span class="hljs-keyword">return</span> list;<br>&#125;<br></code></pre></td></tr></table></figure><p>前端页面 index.jsp ，返回 json 格式为：<code>[&#123;“name”:“wangwu”,“age”:22&#125;,&#123;“name”:“tianmao”,“age”:10&#125;]</code></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;head&gt;<br>    &lt;title&gt;Title&lt;/title&gt;<br>    &lt;script type=&quot;text/javascript&quot; src=&quot;js/jquery-3.5.1.js&quot;&gt;&lt;/script&gt;<br>    &lt;script type=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;<br>        $(function () &#123;<br>            $(<span class="hljs-string">&quot;button&quot;</span>).click(function () &#123;<br>                <span class="hljs-comment">// alert(&quot;button click&quot;);</span><br>               $.ajax(&#123;<br>                   <span class="hljs-comment">// url:&quot;returnVoid-ajax.do&quot;,</span><br>                   <span class="hljs-comment">// url:&quot;returnStudentJson.do&quot;,</span><br>                   url:<span class="hljs-string">&quot;returnStudentJsonArray.do&quot;</span>,<br>                   <br>                   data:&#123;<br>                       name:<span class="hljs-string">&quot;zhangsan&quot;</span>,<br>                       age:<span class="hljs-number">20</span><br>                   &#125;,<br>                   type:<span class="hljs-string">&quot;post&quot;</span>,<br>                   dataType:<span class="hljs-string">&quot;json&quot;</span>,<br>                   success:function(resp) &#123;<br><br>                       <span class="hljs-comment">// alert(resp.name+&quot;   &quot;+resp.age);</span><br><br>                       <span class="hljs-comment">//[&#123;&quot;name&quot;:&quot;wangwu&quot;,&quot;age&quot;:22&#125;,&#123;&quot;name&quot;:&quot;tianmao&quot;,&quot;age&quot;:10&#125;]</span><br>                       $.each(resp,function (i,n) &#123;<br>                            alert(n.name+<span class="hljs-string">&quot;  &quot;</span>+n.age);<br>                       &#125;)<br>                   &#125;<br>               &#125;)<br>            &#125;)<br>        &#125;)<br>    &lt;/script&gt;<br>&lt;/head&gt;<br></code></pre></td></tr></table></figure><p><strong>3）处理器方法返回的是 String，表示数据</strong>，不是视图</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">* 处理器方法返回的是String，String表示数据的，不是视图。</span><br><span class="hljs-comment">* 区分返回值类型String是数据，还是视图，看看有没有@ResponseBody注解</span><br><span class="hljs-comment">* 如果有@ResponseBody注解，返回String就是数据，反之就是视图</span><br><span class="hljs-comment">* */</span><br><br><span class="hljs-meta">@RequestMapping(value = &quot;/returnStringData.do&quot;, produces = &quot;text/palin;charset=utf-8&quot;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">doStringData</span><span class="hljs-params">(String name,Integer age)</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;返回对象，表示数据&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>注意：如果有@ResponseBody注解，返回String就是数据。在ajax请求中，此时不是json，要改成：<code>dataType:&quot;text&quot;</code>。</p><p>然后，中文会出现乱码问题，解决方法：加上produce：<code>@RequestMapping(value = &quot;/returnStringData.do&quot;, produces = &quot;text/palin;charset=utf-8&quot;)</code></p><hr><p><strong>springmvc 处理器方法返回 object，可以转为 json输出到浏览器，响应 ajax 的内部原理</strong>（步骤）：</p><ol type="1"><li><p><code>&lt;mvc:annotation-driven&gt;</code> 注解驱动 注解驱动实现的功能是：完成java对象到 json，xml，test，二进制等数据格式的转换 HttpMessageConverter接口：消息转换器 功能：定义了java转json，xml等数据格式的方法。这个接口有很多实现类。这些实现类完成了java对象到json，Java对象到xml，Java对象到二进制数据的转换</p></li><li><code>HttpMessageConverter</code>接口的两个方法是：控制器类把结果输出给浏览器时使用的 <code>boolean canWrite(Class&lt;?&gt; var1, @Nullable MediaType var2);</code> <code>void write(T var1, @Nullable MediaType var2, HttpOutputMessage var3)</code><ol type="1"><li>canWrite：检查处理器方法返回值，能不能转为var2的数据格式</li><li>write：把处理器方法的返回值对象，调用jackson中的ObjectMapper转为json字符串</li></ol></li><li><p><code>@ResponseBody</code> 注解 放在处理器方法的上面，通过HttpServletResponse输出结果，响应ajax请求</p></li></ol><h2 id="解读-url-pattern">4、解读 <code>&lt;url-pattern/&gt;</code></h2><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193656.png" srcset="/img/loading.gif" lazyload></p><h3 id="配置详解">1. 配置详解</h3><p><strong><em>.do</em></strong></p><p>在没有特殊要求的情况下，springmvc 的中央调度器 DispatcherServlet 的 <code>&lt; url-pattern/ &gt;</code> 常使用后缀匹配方式，如写为 <code>*.do</code> 或者 <code>*.action</code> ， <code>*.mvc</code> 等</p><p><strong>/</strong></p><p>可以写为 / ，因为DispatcherServlet会将向静态资源的获取请求，例如 .css .js .jpg .png 等资源的获取请求，作为是一个普通的Controller请求。中央调度器会调用处理器映射器为其查找相应的处理器。当然也是找不到的，所以在这种情况下，所有的静态资源获取请求也均会报404错误。</p><hr><p>发起的请求是由哪些服务器处理的：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">http: <span class="hljs-regexp">//</span>localhost:<span class="hljs-number">8080</span><span class="hljs-regexp">/05_url_pattern/i</span>ndex.jsp		tomcat<br>http: <span class="hljs-regexp">//</span>localhost:<span class="hljs-number">8080</span><span class="hljs-regexp">/05_url_pattern/im</span>ages/<span class="hljs-number">1</span>.jpg	  tomcat<br>http: <span class="hljs-regexp">//</span>localhost:<span class="hljs-number">8080</span><span class="hljs-regexp">/05_url_pattern/</span>html/test.html	tomcat<br>http: <span class="hljs-regexp">//</span>localhost:<span class="hljs-number">8080</span><span class="hljs-regexp">/05_url_pattern/</span>some.<span class="hljs-keyword">do</span>	springmvc框架（DispatcherServlet）<br></code></pre></td></tr></table></figure><p>tomcat本身能处理静态资源的访问，像html，图片，js文件等都是静态资源</p><p>tomcat的web.xml文件有一个 servlet 名称为 default，在服务器启动时创建。如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>default<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span> <br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.apache.catalina.servlets.DefaultServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>debug<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>listings<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">load-on-startup</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">load-on-startup</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>default<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span>	// &quot;/&quot; 表示静态资源和未映射的请求都给这个default处理<br><span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br></code></pre></td></tr></table></figure><p>这个名叫 default 的 servlet 作用：</p><ol type="1"><li>处理静态资源</li><li>处理未映射到其它servlet的请求</li></ol><p><strong>使用 ” / “ 后，无法访问静态资源，可以访问动态资源</strong></p><ul><li><p>当你的项目使用了 / ，它会替换 tomcat 中的 default。导致所有的静态资源都给DispatcherServlet处理，<u>默认情况下DispatcherServlet没有处理静态资源的能力</u>。没有控制器对象能处理静态资源的访问，所以静态资源（html，js，图片，css）都是404</p></li><li><p>动态资源some.do可以访问，原因是我们程序中有MyController控制器对象，能处理some.do请求</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs xml">// web.xml<br><span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">   		使用框架的时候，url-pattern可以使用两种方式</span><br><span class="hljs-comment">    1.使用扩展名方式，语法 *.xxxx , xxxx时自定义扩展名。常用的方式 *.do, *.action, *.mvc等等</span><br><span class="hljs-comment">        http://localhost:8080/myweb/some.do</span><br><span class="hljs-comment">        http://localhost:8080?myweb/other.do</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    2.使用斜杠 &quot;/&quot;</span><br><span class="hljs-comment">        当你的项目使用了 / ，它会替换 tomcat 中的 default.</span><br><span class="hljs-comment">        导致所有的静态资源都给DispatcherServlet处理，默认情况下DispatcherServlet没有处理静态资源的能力,</span><br><span class="hljs-comment">        没有控制器对象能处理静态资源的访问,所以静态资源（html，js，图片，css）都是404</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">        动态资源some.do可以访问，原因是我们程序中有MyController控制器对象，能处理some.do请求</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="静态资源访问">2. 静态资源访问</h3><h4 id="使用-mvcdefault-servlet-handler-和-mvcannotation-driven">1）使用 <code>&lt;mvc:default-servlet-handler/&gt;</code> 和 <code>&lt; mvc:annotation-driven/ &gt;</code></h4><p>声 明 了 <code>&lt;mvc:default-servlet-handler /&gt;</code> 后 ， springmvc 框 架 会 在 容 器 中 创 建DefaultServletHttpRequestHandler 处理器对象。它会像一个检查员，对进入 DispatcherServlet的 URL 进行筛查，如果发现是静态资源的请求，就将该请求转由 Web 应用服务器默认的Servlet 处理。一般的服务器都有默认的 Servlet。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml">// springmvc.xml<br><br><span class="hljs-comment">&lt;!--@ResponseBody注解驱动--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mvc:annotation-driven</span>/&gt;</span><br><br><span class="hljs-comment">&lt;!--第一种处理静态资源的方式：&lt;mvc:default-servlet-handler/&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    需要在springmvc配置文件加入 &lt;mvc:default-servlet-handler&gt;</span><br><span class="hljs-comment">    原理是：加入这个标签后，框架会创建控制器对象（类似自己创建的MyController）,</span><br><span class="hljs-comment">    这个对象可以把接收到的请求转发给tomcat的名字叫default的servlet</span><br><span class="hljs-comment">--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mvc:default-servlet-handler</span>/&gt;</span><br></code></pre></td></tr></table></figure><h4 id="使用-mvcresources-需要掌握">2）使用 <code>&lt; mvc:resources /&gt;</code> 需要掌握</h4><p>在 Spring3.0 版本后，Spring 定义了专门用于处理静态资源访问请求的处理器 ResourceHttpRequestHandler。并且添加了<code>&lt;mvc:resources/&gt;</code>标签，专门用于解决静态资源无法访问问题。需要在 springmvc 配置文件中添加如下形式的配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mvc:resources</span> <span class="hljs-attr">mapping</span>=<span class="hljs-string">&quot;/images/**&quot;</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;/images/&quot;</span></span><br></code></pre></td></tr></table></figure><ul><li>mapping 表 示 对 该 资 源 的 请 求 （ 以 /images/ 开 始 的 请 求 ， 如 /image/beauty.jpg , /images/car.png 等）。注意，后面是两个星号**。而且，前后两个斜杠不能缺。</li><li>location 表示静态资源所在目录。当然，目录不要使用/WEB-INF/及其子目录。</li></ul><blockquote><p>uri的格式：“ /网站名/资源文件名 ”</p></blockquote><h4 id="声明注解驱动">3）声明注解驱动</h4><p><code>&lt;mvc:resources /&gt;</code> 和 <code>@RequestMapping</code> 有一定的冲突。</p><p>解决动态资源和静态资源冲突的问题，在 springmvc 配置文件加入：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mvc:annotation-dirven</span> /&gt;</span><br></code></pre></td></tr></table></figure><p>静态资源都放到同一个文件夹 static 下面，然后就可以写一个通用的配置语句实现多种静态资源的访问：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mvc:resources</span> <span class="hljs-attr">mapping</span>=<span class="hljs-string">&quot;/static/**&quot;</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;/static/&quot;</span></span><br></code></pre></td></tr></table></figure><h3 id="地址分类">3. 地址分类</h3><p>在jsp ， html中使用的地址， 都是在前端页面中的地址，都是相对地址</p><p>1 绝对地址：带有协议名称的，例如：http://www.baidu.com, ftp://202.122.23.1</p><p>2 相对地址，没有协议开头的，例如：user/some.do，/user/some.do 相对地址不能独立使用，必须有一个参考地址。通过 参考地址+相对地址本身 才能指定资源</p><p>3 参考地址</p><p>1）<strong>在你的页面中，访问地址不加 &quot; / &quot;</strong></p><p>访问地址：http: //localhost:8080/06_path/index.jsp 路径：http: //localhost:8080/06_path/ 资源：index.jsp</p><p>在index.jsp发起 user/some.do请求，访问地址变为 http: //localhost:8080/06_path/test/some.do 在你的地址没有斜杠开头，例如：<code>user/some.do</code>，当你点击链接时，访问地址就是当前页面加上链接的地址 http: //localhost:8080/06_path/ + user/some.do</p><p>2）<strong>在你的页面中，访问地址加 &quot; / &quot;</strong></p><p>访问地址：http: //localhost:8080/06_path/index.jsp 路径：http: //localhost:8080/06_path/ 资源：index.jsp</p><p>点击 <code>/user/some.do</code>，访问地址变为：http: //localhost:8080/test/some.do <strong>参考地址是你的服务器地址，也就是http: //localhost:8080</strong></p><p>如果你的资源不能访问，加上：<code>$&#123;pageContext.request.contextPath&#125;</code>，修改如下</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs jsp"><span class="hljs-comment">//index.jsp</span><br>&lt;body&gt;<br>    &lt;p&gt;第一个springmvc项目&lt;/p&gt;<br>    &lt;p&gt;&lt;a href=&quot;/test/some.do&quot;&gt;发起/test/some.do的get请求&lt;/a&gt;&lt;/p&gt;<br>    &lt;br/&gt;<br>&lt;/body&gt;<br><br><span class="hljs-comment">//修改为</span><br>&lt;body&gt;<br>    &lt;p&gt;第一个springmvc项目&lt;/p&gt;<br>    &lt;p&gt;&lt;a href=&quot;$&#123;pageContext.request.contextPath&#125;/test/some.do&quot;&gt;发起test/some.do的get请求&lt;/a&gt;&lt;/p&gt;<br>    &lt;br/&gt;<br>&lt;/body&gt;<br></code></pre></td></tr></table></figure><h1 id="三springmvc-核心技术">三、SpringMVC 核心技术</h1><h2 id="请求重定向和转发">1、请求重定向和转发</h2><p>当处理器对请求处理完毕后，向其它资源进行跳转时，有两种跳转方式：请求转发与重定向。而根据所要跳转的资源类型，又可分为两类：跳转到页面与跳转到其它处理器。</p><p>注意，对于请求转发的页面，可以是WEB-INF中页面；而重定向的页面，是不能为WEB-INF中页的。因为重定向相当于用户再次发出一次请求，而用户是不能直接访问 WEB-INF 中资源的。</p><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193714.png" srcset="/img/loading.gif" lazyload style="zoom:60%"></p><p>SpringMVC 框架把原来 Servlet 中的请求转发和重定向操作进行了封装。现在可以使用单的方式实现转发和重定向。</p><ul><li><p>forward：表示转发，实现 <code>request.getRequestDispatcher(“xx.jsp”).forward()</code></p></li><li><p>redirect：：：表示重定向，实现 <code>response.sendRedirect(“xxx.jsp”)</code></p></li></ul><p><strong><code>setViewName()</code> 默认是forward。</strong></p><h3 id="forward-请求转发">forward 请求转发</h3><p>有时候你需要转发到不在WEB-INF目录下的jsp界面，但是视图解析器会自动给链接添加WEB-INF的路径</p><blockquote><p>请求转发相当于：你的请求我处理不了，不过我找到一个能帮你处理请求的人过来</p></blockquote><p>处理器方法返回 ModelAndView，实现转发 forward操作</p><ul><li><p>语法：<code>setViewName(&quot;forward:视图文件完整路径&quot;)</code></p></li><li><p>forward特点：不和视图解析器一同使用，就当项目中没有视图解析器</p></li></ul><p>对应控制器</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyController</span> </span>&#123;<br><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/doForward.do&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doSome</span><span class="hljs-params">()</span></span>&#123;<br>        ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>        mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;-----欢迎使用spring mvc做web开发------&quot;</span> );<br>        mv.addObject(<span class="hljs-string">&quot;fun&quot;</span>,<span class="hljs-string">&quot;执行的是doSome方法&quot;</span>);<br><br>        <span class="hljs-comment">//=====================重点===========================</span><br>        <br>        <span class="hljs-comment">//使用视图解析器</span><br>        <span class="hljs-comment">//mv.setViewName(&quot;show&quot;);</span><br>        <br>        <span class="hljs-comment">//显式转发</span><br>        mv.setViewName(<span class="hljs-string">&quot;forward:WEB-INF/view/show.jsp&quot;</span>);<br>        <br>        <span class="hljs-comment">//=====================重点===========================</span><br>        <br>        <span class="hljs-keyword">return</span> mv;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="redirect-重定向">redirect 重定向</h3><p>处理器方法返回ModelAndView，实现转发redirect操作</p><ul><li>语法：<code>setViewName(&quot;redirect:视图文件完整路径&quot;)</code></li><li>redirect特点：也是不和视图解析器一同使用，就当作项目中没有视图解析器</li></ul><p>框架对重定向的操作：</p><ol type="1"><li>框架会把model中的简单类型的数据，转为String使用，作为hello.jsp的get请求参数使用。目的是在 doRedirect.do 和 hello.jsp 两次请求之间传递参数</li><li>在目标hello.jsp可以使用参数集合对象 <code>$(param)</code> 获取请求参数值，格式为：<code>$(param.name)</code></li><li>重定向不能访问WEB-INF资源</li></ol><h2 id="异常处理">2、 异常处理</h2><p>springmvc框架采用的是统一，全局的异常处理。把controller中的所有异常处理都集中到一个地方，采用的是 <strong>AOP</strong> 思想，把业务逻辑和异常处理代码分开。也叫解耦合。</p><p>使用两个注解：</p><ol type="1"><li><code>@ExceptionHandler</code><br></li><li><code>@ControllerAdvice</code></li></ol><p>异常处理主要步骤：</p><ol type="1"><li>新建一个自定义异常类 <code>MyUserException</code>，再定义它的子类 <code>NameException</code>，<code>AgeException</code></li><li>在 <code>controller</code> 抛出 <code>NameException</code>，<code>AgeException</code></li><li>创建一个普通类，作为 全局异常处理类<ol type="1"><li>类上面加上 <code>@ControllerAdvice</code></li><li>类中方法上面加上 <code>@ExceptionHandler</code></li></ol></li><li>创建对应视图。创建组件扫描器，扫描 <code>@Controller</code> 注解 和 <code>@ControllerAdvice</code>所在的包名。声明注解驱动。</li></ol><hr><ul><li>springmvc.xml，加入组件扫描器和注解驱动</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--处理异常两个步骤--&gt;</span><br><br><span class="hljs-comment">&lt;!--1、组件扫描器：扫描全局异常处理程序--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.bjpowernode..handler&quot;</span>/&gt;</span><br><br><span class="hljs-comment">&lt;!--2、注解驱动--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mvc:annotation-driven</span>/&gt;</span><br></code></pre></td></tr></table></figure><ul><li>MyController.java，控制器方法，向 MyUserException 抛出异常</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyController</span> </span>&#123;<br><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/some.do&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doSome</span><span class="hljs-params">(String name, Integer age)</span> <span class="hljs-keyword">throws</span> MyUserException </span>&#123;<br>        ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br><br>        <span class="hljs-comment">//根据请求抛出异常</span><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-string">&quot;zs&quot;</span>.equals(name))&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NameException(<span class="hljs-string">&quot;姓名不正确&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (age &lt;= <span class="hljs-number">0</span> || age &gt;= <span class="hljs-number">99</span> || age == <span class="hljs-keyword">null</span>)&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AgeException(<span class="hljs-string">&quot;年龄输入有误&quot;</span>);<br>        &#125;<br>        <br>        mv.addObject(<span class="hljs-string">&quot;name&quot;</span>,name);<br>        mv.addObject(<span class="hljs-string">&quot;age&quot;</span>,age);<br>        mv.setViewName(<span class="hljs-string">&quot;show&quot;</span>);<br>        <span class="hljs-keyword">return</span> mv;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>exception 文件夹下面的自定义异常类 MyUserException.java，继承 Exception</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyUserException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Exception</span></span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyUserException</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyUserException</span><span class="hljs-params">(String message)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(message);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>子类 NameException.java ：表示当前用户姓名有异常，抛出 NameException</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//表示当前用户姓名有异常，抛出NameException</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NameException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MyUserException</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">NameException</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">NameException</span><span class="hljs-params">(String message)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(message);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>下面创建一个GlobalExceptionHandler.java，作为 全局异常处理类</strong></p><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193741.png" srcset="/img/loading.gif" lazyload></p><h3 id="controlleradvice"><span class="citation" data-cites="ControllerAdvice">@ControllerAdvice</span></h3><p>控制器增强 (可以理解为：给控制器类增加异常处理功能)，放在类上面</p><p>特点：必须让框架知道这个注解所在的包名，需要在springmvc配置文件声明 组件扫描器</p><p>指定 <span class="citation" data-cites="ControllerAdvice">@ControllerAdvice</span> 所在的全局异常处理类包名</p><h3 id="exceptionhandler"><span class="citation" data-cites="ExceptionHandler">@ExceptionHandler</span></h3><p><span class="citation" data-cites="ExceptionHandler">@ExceptionHandler</span>(异常的class)：表示异常的类型，当发生此类型的异常时，由当前方法处理。放在方法上面</p><p>处理异常的方法和控制器方法的定义一样，可以有多个参数，可以有ModelAndView，String，void，对象类型的返回值</p><p>形参：Exception，表示Controller中抛出的异常对象，通过形参可以获取发送的异常信息</p><hr><p>MyController.java 出现异常，跳转到异常处理程序，找 ExceptionHandler</p><ul><li>handler 文件夹下面的 GlobalExceptionHandler.java 异常处理程序</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//@ControllerAdvice 增强控制器</span><br><span class="hljs-meta">@ControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GlobalExceptionHandler</span> </span>&#123;<br>	<br>    <span class="hljs-comment">//处理NameException异常</span><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    	异常发生时的处理逻辑：</span><br><span class="hljs-comment">    	1. 需要把异常记录下来。记录到数据库，日志文件。</span><br><span class="hljs-comment">    	2. 发送通知，把异常的信息通过邮件短信微信发送给相关人员。</span><br><span class="hljs-comment">    	3. 给用户友好的提示。</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-meta">@ExceptionHandler(value = NameException.class)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doNameException</span><span class="hljs-params">(Exception exception)</span></span>&#123;<br><br>        ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>        mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>, <span class="hljs-string">&quot;用户名必须是zs，其他用户不能访问&quot;</span>);<br>        mv.addObject(<span class="hljs-string">&quot;ex&quot;</span>, exception);<br>        <span class="hljs-comment">//指定视图</span><br>        mv.setViewName(<span class="hljs-string">&quot;nameError&quot;</span>);<br>        <span class="hljs-keyword">return</span> mv;<br>    &#125;<br><br>    <span class="hljs-comment">//处理AgeException异常</span><br>    <span class="hljs-meta">@ExceptionHandler(value = AgeException.class)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doAgeException</span><span class="hljs-params">(Exception exception)</span></span>&#123;<br>        ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>        mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;年龄输入范围有误&quot;</span>);<br>        mv.addObject(<span class="hljs-string">&quot;ex&quot;</span>,exception);<br>        mv.setViewName(<span class="hljs-string">&quot;ageError&quot;</span>);<br>        <span class="hljs-keyword">return</span> mv;<br><br>    &#125;<br><br>    <span class="hljs-comment">//处理NameException，AgeException以外的，不知类型的异常</span><br>    <span class="hljs-meta">@ExceptionHandler</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">doOtherException</span><span class="hljs-params">(Exception exception)</span></span>&#123;<br>        ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>        mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;其他不知类型的异常&quot;</span>);<br>        <span class="hljs-comment">//指定视图</span><br>        mv.setViewName(<span class="hljs-string">&quot;defaultError&quot;</span>);<br>        <span class="hljs-keyword">return</span> mv;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="拦截器">3、拦截器</h2><h4 id="拦截器说明">拦截器说明：</h4><ol type="1"><li><p>拦截器是springmvc中的一种，需要实现 <code>HandlerInterceptor</code> 接口</p></li><li><p>拦截器和过滤器类似，功能方向侧重点不同。</p><ul><li><p><strong>过滤器是用来过滤请求参数，设置编码字符集等工作。</strong></p></li><li><p><strong>拦截器是拦截用户的请求，对请求做判断处理的。</strong></p></li></ul></li><li><p>拦截器是全局的，可以对多个Controller做拦截。</p><p>一个项目中可以有0个或多个拦截器，他们在一起拦截用户的请求。</p></li><li><p>拦截器常用在：用户登录处理，权限检查，记录日志。</p></li></ol><h4 id="拦截器的使用步骤">拦截器的使用步骤：</h4><ol type="1"><li>定义普通类实现 <code>HandlerInterceptor</code> 接口，实现接口的三个方法</li><li>在springmvc文件中，声明拦截器(让框架知道拦截器的存在)，指定拦截请求的uri地址</li></ol><h4 id="拦截器的执行时间">拦截器的执行时间：</h4><ol type="1"><li>在请求处理之前，也就是controller类中方法执行之前先被拦截</li><li>在控制器方法执行之后也会执行拦截器</li><li>在请求处理完成后也会执行拦截器</li></ol><hr><ul><li>在主配置文件springmvc.xml中，声明拦截器</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--声明拦截器：拦截器可以有0个或者多个--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptors</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--声明一个拦截器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptor</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">        指定拦截请求的uri地址</span><br><span class="hljs-comment">            path：就是uri地址，可以使用通配符 **</span><br><span class="hljs-comment">              **：表示任意字符，文件或者多级目录中的文件</span><br><span class="hljs-comment">        --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">mvc:mapping</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/**&quot;</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!--声明拦截器对象--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.bjpowernode.handler.MyInterceptor&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptor</span>&gt;</span><br>    <br><span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptors</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="prehandle预处理方法重要">preHandle：预处理方法（重要）</h3><p>预处理方法：preHandle。重要：是整个项目的入口，门户</p><ul><li><p>当preHandle返回true，请求可以被处理</p></li><li><p>当preHandle返回false，请求到此方法就截止</p></li></ul><p>参数：Object handler：被拦截的控制器对象</p><p>返回值：boolean</p><ul><li><p><strong>true：请求通过拦截器验证，可以处理拦截器方法</strong></p><p>控制台显示结果：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">MyInterceptor拦截器的pre<span class="hljs-constructor">Handle()</span>方法执行了！<br>MyController控制器的<span class="hljs-keyword">do</span><span class="hljs-constructor">Some()</span>方法执行！<br>MyInterceptor拦截器的post<span class="hljs-constructor">Handle()</span>方法执行了！<br>MyInterceptor拦截器的after<span class="hljs-constructor">Completion()</span>方法执行了！<br></code></pre></td></tr></table></figure></li><li><p><strong>false：请求没有通过拦截器的验证，请求到达拦截器就截止了。请求没有被处理</strong></p><p>控制台显示结果：</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">MyInterceptor</span>拦截器的<span class="hljs-function"><span class="hljs-title">preHandle</span>()方法执行了！</span><br></code></pre></td></tr></table></figure><p>特点：</p></li></ul><ol type="1"><li><p><strong>该方法在控制器方法（MyController的doSome）之前执行，用户请求首先到达该方法</strong></p></li><li><p>在该方法中可以获取请求的信息，验证请求是否符合要求。</p><p>可以验证用户是否登录，验证用户是否有权访问某个连接地址（url）。如果验证失败，可以截断请求；如果验证成功，可以放行请求，此时控制器方法才能执行</p></li></ol><hr><p>创建一个MyInterceptor.java，作为拦截器类，继承自HandlerInterceptor，实现三个方法：preHandle，postHandle，afterCompletion</p><p><strong>拦截器类：看作是多个控制器中公用的功能，集中到拦截器统一处理，使用的是aop思想（面向切面编程）。</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//拦截器类：看作是多个控制器中公用的功能，集中到拦截器统一处理，使用的是aop思想（面向切面编程）。</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HandlerInterceptor</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;MyInterceptor拦截器的preHandle()方法执行了！&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>   <span class="hljs-comment">/*</span><br><span class="hljs-comment">    * 后处理方法：postHandle</span><br><span class="hljs-comment">    * 参数：</span><br><span class="hljs-comment">    * Object handler：被拦截的处理器对象MyController</span><br><span class="hljs-comment">    * ModelAndView mv：处理器方法的返回值</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * 特点：</span><br><span class="hljs-comment">    *   1、在处理器方法(MyController.doSome)之后执行</span><br><span class="hljs-comment">    *   2、能够获取到处理器方法的返回值ModelAndView，可以修改ModelAndView中的数据和视图，会影响到最后的输出结果</span><br><span class="hljs-comment">    *   3、主要是对原来的执行结果做第二次修正</span><br><span class="hljs-comment">    * */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView mv)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;MyInterceptor拦截器的postHandle()方法执行了！&quot;</span>);<br>    &#125;<br><br>   <span class="hljs-comment">/*</span><br><span class="hljs-comment">    * 最后执行方法：afterCompletion</span><br><span class="hljs-comment">    * 参数：</span><br><span class="hljs-comment">    *   Object handler：被拦截的处理器对象</span><br><span class="hljs-comment">    *   Exception ex：程序中发生的异常</span><br><span class="hljs-comment">    * 特点：</span><br><span class="hljs-comment">    *   1、在请求处理完成后执行。框架中规定是你的视图处理完成后，对视图执行了forward。就认为请求处理完成。</span><br><span class="hljs-comment">    *   2、一般做资源回收，程序请求中创建的一些对象，在这里删除，回收占用的内存</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;MyInterceptor拦截器的afterCompletion()方法执行了！&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193801.png" srcset="/img/loading.gif" lazyload style="zoom:67%"></p><ul><li>多个拦截器时</li></ul><p>在框架中保存多个拦截器是ArrayList， 按照声明的先后顺序放入ArrayList</p><p><img src="https://cdn.jsdelivr.net/gh/stuxiaozhang/blogimage/img/20220711193808.png" srcset="/img/loading.gif" lazyload style="zoom:50%"></p><p>1、第一个拦截器preHandle=true，第二个拦截器preHandle=true</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java">第一个拦截器类<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HandlerInterceptor</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;11111--MyInterceptor拦截器的preHandle()方法执行了！&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br>        <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">postHandle</span><span class="hljs-params">(......)</span></span>&#123;<br>         System.out.println(<span class="hljs-string">&quot;11111--MyInterceptor拦截器的postHandle()方法执行了！&quot;</span>);<br>    &#125;<br>        .....<br><br>第二个拦截器类<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyInterceptor2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HandlerInterceptor</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;22222--MyInterceptor拦截器的preHandle()方法执行了！&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br>        <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">postHandle</span><span class="hljs-params">(......)</span></span>&#123;<br>         System.out.println(<span class="hljs-string">&quot;22222--MyInterceptor拦截器的postHandle()方法执行了！&quot;</span>);<br>    &#125;<br>        .....<br>            <br></code></pre></td></tr></table></figure><ul><li>配置文件中也要同时声明两个拦截器</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptors</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--声明一个拦截器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptor</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">mvc:mapping</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/**&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.zh.handler.MyInterceptor&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptor</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--声明第二个拦截器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptor</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">mvc:mapping</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/**&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.zh.handler.MyInterceptor2&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptor</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptors</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>运行结果如下</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-number">11111</span>--MyInterceptor拦截器的pre<span class="hljs-constructor">Handle()</span>方法执行了！<br><span class="hljs-number">22222</span>--MyInterceptor拦截器的pre<span class="hljs-constructor">Handle()</span>方法执行了！<br>MyController控制器的<span class="hljs-keyword">do</span><span class="hljs-constructor">Some()</span>方法执行！<br><span class="hljs-number">22222</span>--MyInterceptor拦截器的post<span class="hljs-constructor">Handle()</span>方法执行了！<br><span class="hljs-number">11111</span>--MyInterceptor拦截器的post<span class="hljs-constructor">Handle()</span>方法执行了！<br><span class="hljs-number">22222</span>--MyInterceptor拦截器的after<span class="hljs-constructor">Completion()</span>方法执行了！<br><span class="hljs-number">11111</span>--MyInterceptor拦截器的after<span class="hljs-constructor">Completion()</span>方法执行了！<br></code></pre></td></tr></table></figure><p>2、第一个拦截器preHandle=true，第二个拦截器preHandle=false</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-number">11111</span><span class="hljs-comment">--MyInterceptor拦截器的preHandle()方法执行了！</span><br><span class="hljs-number">22222</span><span class="hljs-comment">--MyInterceptor拦截器的preHandle()方法执行了！</span><br><span class="hljs-number">11111</span><span class="hljs-comment">--MyInterceptor拦截器的afterCompletion()方法执行了！</span><br></code></pre></td></tr></table></figure><p>3、第一个拦截器preHandle=false，第二个拦截器preHandle=true</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-number">11111</span><span class="hljs-comment">--MyInterceptor拦截器的preHandle()方法执行了！</span><br></code></pre></td></tr></table></figure><h3 id="拦截器和过滤器的区别">拦截器和过滤器的区别</h3><ol type="1"><li><p>过滤器是servlet中的对象，拦截器是框架中的对象</p></li><li><p>拦截器拦截普通类方法执行，过滤器过滤servlet请求响应</p></li><li><p>过滤器实现Filter接口，拦截器实现HandlerInterceptor</p></li><li><p>过滤器是用来设置request，response的参数，属性，侧重对数据过滤的</p><p>拦截器用来验证请求，能截断请求</p></li><li><p>过滤器是在拦截器之前先执行</p></li><li><p>过滤器是tomcat服务器创建的对象</p><p>拦截器是springmvc容器中创建的对象</p></li><li><p>过滤器是一个执行时间点</p><p>拦截器是三个执行时间点</p></li><li><p>过滤器可以处理jsp，js，html等</p><p>拦截器是侧重拦截对Controller的对象。如果你的请求不能被DispatcherServlet接收，这个请求不会执行拦截器内容</p></li></ol></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/Java/">Java</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/tags/SpringMVC/">SpringMVC</a></div></div><p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处来源：<a href="https://stuxiaozhang.github.io/">小张的宇宙空间站</a></p><div class="post-prevnext"><article class="post-prev col-6"><a href="/2022/07/28/git/"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">Git笔记</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2022/06/24/Spring%E7%AC%94%E8%AE%B0/"><span class="hidden-mobile">Spring笔记</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments" lazyload><div id="valine"></div><script type="text/javascript">Fluid.utils.loadComments("#valine",function(){Fluid.utils.createScript("https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js",function(){var e=Object.assign({appId:"81O1jSOqY3veRxOg71BDYfri-gzGzoHsz",appKey:"CgnvRL262D07ied40NiXm2VL",placeholder:"快来评论鸭~",path:"window.location.pathname",avatar:"retro",meta:["nick","mail","link"],pageSize:10,lang:"zh-CN",highlight:!0,recordIP:!0,serverURLs:"",emojiCDN:"https://cdn.bootcdn.net/ajax/libs/emojione/4.5.0/lib/js/emojione.min.js",emojiMaps:null,enableQQ:!0,requiredFields:["nick"]},{el:"#valine",path:window.location.pathname});new Valine(e)})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"><a href="https://stuxiaozhang.github.io" target="_blank" rel="nofollow noopener"><span>小张同学的宇宙空间站</span></a> 已经运转了<span id="timeDate">载入天数...</span><script src="/js/duration.js"></script></div><div class="statistics"><span id="leancloud-site-pv-container" style="display:none">总访问量 <span id="leancloud-site-pv"></span> 次 </span><span id="leancloud-site-uv-container" style="display:none">总访客数 <span id="leancloud-site-uv"></span> 人</span></div></footer><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script><script src="/js/local-search.js"></script><script defer src="/js/leancloud.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js"></script><script>!function(t){(0,Fluid.plugins.typing)(t.getElementById("subtitle").title)}((window,document))</script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},options:{renderActions:{findScript:[10,a=>{document.querySelectorAll('script[type^="math/tex"]').forEach(e=>{var t=!!e.type.match(/; *mode=display/);const n=new a.options.MathItem(e.textContent,a.inputJax[0],t);t=document.createTextNode("");e.parentNode.replaceChild(t,e),n.start={node:t,delim:"",n:0},n.end={node:t,delim:"",n:0},a.math.push(n)})},"",!1],insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(e=>{let t=e.parentNode;"li"===t.nodeName.toLowerCase()&&t.parentNode.classList.add("has-jax")})},"",!1]}}}</script><script async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.4/es5/tex-svg.js"></script><script src="/js/boot.js"></script></body></html>