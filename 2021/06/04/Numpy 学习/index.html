<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;auto&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="https://gitee.com/stuxiaozhang/blogimage/raw/master/img/mytheme/favicon.png"><link rel="icon" href="https://gitee.com/stuxiaozhang/blogimage/raw/master/img/mytheme/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content="Numpy
本文是 Numpy 的简单学习笔记。
为什么使用 Numpy ？
对于同样的数值计算任务，使用 Numpy 比直接编写 Python 代码实现，优点：

代码更简洁：Numpy 直接以数组、矩阵为力度计算并且支持大量的数学函数，而 Python 需要用 for 循环从底层实现
性能更高效：Numpy 的数组存储效率和输入输出计算性能，比 Python 使用 List 或者嵌"><meta name="author" content="小张同学"><meta name="keywords" content=""><title>Numpy 学习 - 小张同学的博客</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"stuxiaozhang.github.io",root:"/",version:"1.8.11",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},copy_btn:!0,image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:4},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:"81O1jSOqY3veRxOg71BDYfri-gzGzoHsz",app_key:"CgnvRL262D07ied40NiXm2VL",server_url:null}},search_path:"/local-search.xml"}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.3.0"></head><body><header style="height:50vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>xiaozhang's space</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/schedule/"><i class="iconfont icon-cliplist"></i> 动态</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner" id="banner" parallax="true" style="background:url(https://gitee.com/stuxiaozhang/blogimage/raw/master/img/mytheme/post.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="Numpy 学习"></span><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> 小张同学 </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2021-06-04 08:39" pubdate>2021年6月4日</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 5.1k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 51 分钟 </span><span id="leancloud-page-views-container" class="post-meta" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="leancloud-page-views"></span> 次</span></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="d-none d-lg-block col-lg-1"></div><div class="col-lg-9 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">Numpy 学习</h1><p class="note note-info">本文最后更新于：2021年6月7日</p><div class="markdown-body"><h1 id="numpy">Numpy</h1><p>本文是 Numpy 的简单学习笔记。</p><h2 id="为什么使用-numpy">为什么使用 Numpy ？</h2><p>对于同样的数值计算任务，使用 Numpy 比直接编写 Python 代码实现，<strong>优点</strong>：</p><ol type="1"><li><p><strong>代码更简洁</strong>：Numpy 直接以数组、矩阵为力度计算并且支持大量的数学函数，而 Python 需要用 for 循环从底层实现</p></li><li><p><strong>性能更高效</strong>：Numpy 的数组存储效率和输入输出计算性能，比 Python 使用 List 或者嵌套 List 好很多</p><p>注：</p><ul><li>Numpy 的数据存储和 Python 原生的 List 是不一样的</li><li>Numpy 的大部分代码都是 C 语言实现的，这是 Numpy 比纯 Python 代码高效的原因</li></ul></li></ol><p>举个栗子： 需求：实现两个数组的加法。数组A是1 ~ N数字的平方。数组B是1 ~ N数字的立方</p><ol type="1"><li>使用 Python 元素原生语法实现</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">python_sum</span>(<span class="hljs-params">n</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Python实现数组的加法</span><br><span class="hljs-string">    @param n：数组的长度</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    a = [i**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br>    b = [i**<span class="hljs-number">3</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br>    c = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        c.append(a[i] + b[i])<br>    <span class="hljs-keyword">return</span> c<br><br><br>python_sum(<span class="hljs-number">10</span>)<br><br><span class="hljs-meta">&gt;&gt;&gt; </span>[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">36</span>, <span class="hljs-number">80</span>, <span class="hljs-number">150</span>, <span class="hljs-number">252</span>, <span class="hljs-number">392</span>, <span class="hljs-number">576</span>, <span class="hljs-number">810</span>]<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>使用 Numpy 实现</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">numpy_sum</span>(<span class="hljs-params">n</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Numpy实现数组的加法</span><br><span class="hljs-string">    @param n：数组的长度</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    a = np.arange(n) ** <span class="hljs-number">2</span><br>    b = np.arange(n) ** <span class="hljs-number">3</span><br>    <span class="hljs-keyword">return</span> a + b<br><br><br>numpy_sum(<span class="hljs-number">10</span>)  <span class="hljs-comment"># 生成的不是list，是numpy array</span><br><br><span class="hljs-meta">&gt;&gt;&gt; </span>array([  <span class="hljs-number">0</span>,   <span class="hljs-number">2</span>,  <span class="hljs-number">12</span>,  <span class="hljs-number">36</span>,  <span class="hljs-number">80</span>, <span class="hljs-number">150</span>, <span class="hljs-number">252</span>, <span class="hljs-number">392</span>, <span class="hljs-number">576</span>, <span class="hljs-number">810</span>], dtype=int32)<br></code></pre></td></tr></table></figure><p>性能对比：执行10000次(明显numpy快)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">%timeit python_sum(<span class="hljs-number">10000</span>)<br><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">10.6</span> ms ± <span class="hljs-number">410</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">100</span> loops each)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">%timeit numpy_sum(<span class="hljs-number">10000</span>)<br><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">56.2</span> µs ± <span class="hljs-number">2.06</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">10000</span> loops each)<br></code></pre></td></tr></table></figure><h2 id="numpy-的核心-ndarray-对象">Numpy 的核心 ndarray 对象</h2><p><strong>array对象的背景：</strong></p><ul><li>Numpy 的核心数据结构，就叫做 <strong>array，就是数组，</strong> 也叫 ndarray，array 对象可以是一维数组，也可以是多维数组；</li><li>Python 的 List 也可以实现相同的功能，但是 array 比 List 的优点在于性能好、包含数组元数据信息、大量的快捷函数；</li><li>Numpy 成为事实上的 Scipy、Pandas、Scikit-Learn、Tensorflow、PaddlePaddle 等框架的“通用底层语言”</li><li>Numpy 的 array 和 Python 的 List 的一个区别，是他元素必须都是同一种数据类型，比如都是数字 int 类型，这也是 Numpy 高性能的一个原因</li></ul><p><strong>array本身的属性：</strong></p><ul><li>shape：返回一个元组，表示 array 的维度</li><li>ndim：一个数字，表示 array 的维度的数目</li><li>size：一个数字，表示 array 中所有数据元素的数目</li><li>dtype：array 中元素的数据类型</li></ul><p><strong>创建 array 的方法：</strong></p><ul><li>从 Python 的列表 List 或 tuple 和嵌套列表创建 array</li><li>使用 predefined 函数 <code>arange</code>、<code>ones/ones_like</code>、<code>zeros/zeros_like</code>、<code>empty/empty_like</code>、<code>full/full_like</code>、<code>eye</code> 等函数创建</li><li>生成随机数的 <code>np.random</code> 模块构建</li><li>....</li></ul><p><strong>array 本身支持的大量操作和函数：</strong></p><ul><li>直接逐元素的加减乘除等算数操作</li><li>更好用的面向多维的数组索引</li><li>求 sum/mean 等聚合函数</li><li>线性代数函数，比如求解逆矩阵、求解方程组</li></ul><h3 id="创建-ndarray">1. 创建 ndarray</h3><h4 id="方法1通过-python-的-list-或-tuple-创建-ndarray">方法1：通过 Python 的 list 或 tuple 创建 ndarray</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 创建一个一维数组，也就是Python的单元素List</span><br>x = np.array([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>])<br><span class="hljs-comment"># 一种典型的错误情况：x = np.array(1,2,3,4)</span><br><br><span class="hljs-comment"># 创建一个二维数组，也就是Python的嵌套List</span><br>X = np.array(<br>    [<br>        [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>],<br>        [<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>]<br>    ]<br>) <br><br><br>b = np.array([(<span class="hljs-number">1.5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>), (<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>)])<br></code></pre></td></tr></table></figure><h4 id="方法2用占位符创建已知尺寸的数组">方法2：用占位符创建已知尺寸的数组</h4><p>使用 predefined 函数 <code>arange</code>、<code>ones/ones_like</code>、<code>zeros/zeros_like</code>、<code>empty/empty_like</code>、<code>full/full_like</code>、<code>eye</code> 等函数创建。不用扩张数组，因为扩张数组很耗时。默认dtype是float64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">d = np.zeros((<span class="hljs-number">3</span>, <span class="hljs-number">4</span>))<br>e = np.ones( (<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>), dtype=np.int16 )  <span class="hljs-comment"># 也可以自定义元素类型</span><br>f = np.empty( (<span class="hljs-number">2</span>, <span class="hljs-number">3</span>) )  <span class="hljs-comment"># 根据内存状态随机初始化数组, 注意：数据是未初始化的，里面的值可能是随机值 不要用</span><br>g = np.full((<span class="hljs-number">2</span>, <span class="hljs-number">4</span>), <span class="hljs-number">333</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[<span class="hljs-number">333</span>, <span class="hljs-number">333</span>, <span class="hljs-number">333</span>, <span class="hljs-number">333</span>],<br>       [<span class="hljs-number">333</span>, <span class="hljs-number">333</span>, <span class="hljs-number">333</span>, <span class="hljs-number">333</span>]])<br></code></pre></td></tr></table></figure><h4 id="方法3arange-创建数组">方法3：arange 创建数组</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># arange类似于Python内置的range</span><br>h = np.arange(<span class="hljs-number">2</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>)  <span class="hljs-comment"># 从2开始，到10(不包括10)，步长为2</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>array([<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>])<br><br>i = np.arange( <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0.3</span> )  <span class="hljs-comment"># 接受小数参数。由于浮点数精度的原因，可能无法知道数组最后有多少个数</span><br></code></pre></td></tr></table></figure><h4 id="方法4使用-random-模块生成随机数的数组">方法4：使用 random 模块生成随机数的数组</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">j = np.random.randn(<span class="hljs-number">3</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([ <span class="hljs-number">0.53559186</span>, -<span class="hljs-number">0.99885635</span>, -<span class="hljs-number">1.54424476</span>])<br><br>k = np.random.randn(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[ <span class="hljs-number">0.20762079</span>,  <span class="hljs-number">0.07757193</span>],<br>       [-<span class="hljs-number">1.06316427</span>,  <span class="hljs-number">1.5224711</span> ],<br>       [ <span class="hljs-number">0.88357521</span>,  <span class="hljs-number">0.05296014</span>]])<br><br>l = np.random.randn(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>)  <span class="hljs-comment"># 三块，每块都是2行4列数组</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[[ <span class="hljs-number">1.19593566</span>,  <span class="hljs-number">1.3488425</span> , -<span class="hljs-number">1.170022</span>  , -<span class="hljs-number">0.61150356</span>],<br>        [-<span class="hljs-number">0.75687196</span>, -<span class="hljs-number">1.34909095</span>,  <span class="hljs-number">0.1344865</span> , -<span class="hljs-number">0.74720613</span>]],<br><br>       [[-<span class="hljs-number">0.78072672</span>,  <span class="hljs-number">1.82332708</span>,  <span class="hljs-number">0.64621885</span>, -<span class="hljs-number">0.17998274</span>],<br>        [-<span class="hljs-number">0.61729393</span>, -<span class="hljs-number">1.86046175</span>,  <span class="hljs-number">0.65815736</span>,  <span class="hljs-number">0.52321533</span>]],<br><br>       [[ <span class="hljs-number">0.3204662</span> , -<span class="hljs-number">0.6458647</span> ,  <span class="hljs-number">0.8711224</span> , -<span class="hljs-number">1.51023464</span>],<br>        [ <span class="hljs-number">1.47456684</span>,  <span class="hljs-number">0.04745808</span>,  <span class="hljs-number">0.6639226</span> , -<span class="hljs-number">1.9164821</span> ]]])<br></code></pre></td></tr></table></figure><p>创建 array 的所有方法：<code>array</code>， <code>zeros</code>， <code>zeros_like</code>， <code>ones</code>，<code>ones_like</code>，<code>empty</code>，<code>empty_like</code>，<code>arange</code>，<code>linspace</code>，<code>numpy.random.Generator.rand</code>，<code>numpy.random.Generator.randn</code>，<code>fromfunction</code>，<code>fromfile</code>。</p><h3 id="数组-array-的属性">2. 数组 array 的属性</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ndarray的重要属性</span><br><br>print(<span class="hljs-string">&quot;ndarray类型为&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">type</span>(a)))<br>print(<span class="hljs-string">&quot;ndarray的维度ndim为&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(a.ndim))<br>print(<span class="hljs-string">&quot;ndarray的shape为&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(a.shape))<br>print(<span class="hljs-string">&quot;ndarray总的元素数size为&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(a.size))  <span class="hljs-comment">#a.shape元素乘积</span><br>print(<span class="hljs-string">&quot;ndarray元素类型dtype为&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(a.dtype))  <span class="hljs-comment">#这句是我加的</span><br>print(<span class="hljs-string">&quot;ndarray元素类型dtype.name为&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(a.dtype.name))  <span class="hljs-comment">#官方代码不知道为什么多出了这个name</span><br>print(<span class="hljs-string">&quot;ndarray每个元素占据的字节数itemsize为&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(a.itemsize))<br>print(<span class="hljs-string">&quot;ndarray元素的buffer data为&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(a.data))<br><br><br><span class="hljs-meta">&gt;&gt;&gt; </span>ndarray类型为&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> &#x27;<span class="hljs-title">numpy</span>.<span class="hljs-title">ndarray</span>&#x27;&gt;</span><br><span class="hljs-class"><span class="hljs-title">ndarray</span>的维度<span class="hljs-title">ndim</span>为2</span><br><span class="hljs-class"><span class="hljs-title">ndarray</span>的<span class="hljs-title">shape</span>为(<span class="hljs-params"><span class="hljs-number">3</span>, <span class="hljs-number">5</span></span>)</span><br><span class="hljs-class"><span class="hljs-title">ndarray</span>总的元素数<span class="hljs-title">size</span>为15</span><br><span class="hljs-class"><span class="hljs-title">ndarray</span>元素类型<span class="hljs-title">dtype</span>为<span class="hljs-title">int32</span></span><br><span class="hljs-class"><span class="hljs-title">ndarray</span>元素类型<span class="hljs-title">dtype</span>.<span class="hljs-title">name</span>为<span class="hljs-title">int32</span></span><br><span class="hljs-class"><span class="hljs-title">ndarray</span>每个元素占据的字节数<span class="hljs-title">itemsize</span>为4</span><br><span class="hljs-class"><span class="hljs-title">ndarray</span>元素的<span class="hljs-title">buffer</span> <span class="hljs-title">data</span>为&lt;<span class="hljs-title">memory</span> <span class="hljs-title">at</span> 0<span class="hljs-title">x000002CFFE04BE48</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="基础数学运算">3. 基础数学运算</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python">a = np.array( [<span class="hljs-number">20</span>,<span class="hljs-number">30</span>,<span class="hljs-number">40</span>,<span class="hljs-number">50</span>] )<br>b = np.arange( <span class="hljs-number">4</span> )<br>print(<span class="hljs-string">&quot;a-b是&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(a-b))<br>print(<span class="hljs-string">&quot;a**2是&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(a**<span class="hljs-number">2</span>))<br>print(<span class="hljs-string">&quot;10*np.sin(a)是&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-number">10</span>*np.sin(a)))<br>print(<span class="hljs-string">&quot;a&lt;35是&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(a&lt;<span class="hljs-number">35</span>))<br>print(<span class="hljs-string">&quot;a*b是&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(a*b))<br><br><span class="hljs-comment"># 矩阵乘法</span><br>A = np.array( [[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>], [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]] )<br>B = np.array( [[<span class="hljs-number">2</span>,<span class="hljs-number">0</span>], [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]] )<br>print(<span class="hljs-string">&quot;A*B是&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(A*B))  <span class="hljs-comment"># 乘积运算符 * 在 NumPy 数组中按元素进行运算</span><br>print(<span class="hljs-string">&quot;A@B是&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(A@B))  <span class="hljs-comment"># 矩阵乘积</span><br>print(<span class="hljs-string">&quot;A.dot(B)是&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(A.dot(B)))  <span class="hljs-comment"># 矩阵乘积</span><br><br><span class="hljs-comment"># +=，*= 等运算符进行原地运算，即修改现有数组而不是创建新数组（需要加同类型的，如果不能强制转换就会报错）</span><br><br><span class="hljs-meta">&gt;&gt;&gt; </span>a-b是[<span class="hljs-number">20</span> <span class="hljs-number">29</span> <span class="hljs-number">38</span> <span class="hljs-number">47</span>]<br>a**<span class="hljs-number">2</span>是[ <span class="hljs-number">400</span> <span class="hljs-number">900</span> <span class="hljs-number">1600</span> <span class="hljs-number">2500</span>]<br>10np.sin(a)是[ <span class="hljs-number">9.12945251</span> -<span class="hljs-number">9.88031624</span> <span class="hljs-number">7.4511316</span> -<span class="hljs-number">2.62374854</span>]<br>a&lt;<span class="hljs-number">35</span>是[ <span class="hljs-literal">True</span> <span class="hljs-literal">True</span> <span class="hljs-literal">False</span> <span class="hljs-literal">False</span>]<br>ab是[ <span class="hljs-number">0</span> <span class="hljs-number">30</span> <span class="hljs-number">80</span> <span class="hljs-number">150</span>]<br><br>A*B是[[<span class="hljs-number">2</span> <span class="hljs-number">0</span>]<br>[<span class="hljs-number">0</span> <span class="hljs-number">4</span>]]<br><br>A@B是[[<span class="hljs-number">5</span> <span class="hljs-number">4</span>]<br>[<span class="hljs-number">3</span> <span class="hljs-number">4</span>]]<br><br>A.dot(B)是[[<span class="hljs-number">5</span> <span class="hljs-number">4</span>]<br>[<span class="hljs-number">3</span> <span class="hljs-number">4</span>]]<br></code></pre></td></tr></table></figure><h2 id="numpy-对数组按索引查询">Numpy 对数组按索引查询</h2><p>三种索引方法：</p><ul><li>基础索引</li><li>神奇索引</li><li>布尔索引</li></ul><h3 id="基础索引">基础索引</h3><h4 id="一维数组">一维数组</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 和 Python 的 list 一样，包括前面，不包括后面</span><br><span class="hljs-comment"># 一维向量</span><br>x = np.arange(<span class="hljs-number">10</span>)  <span class="hljs-comment"># array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span><br>print(x[<span class="hljs-number">2</span>], x[<span class="hljs-number">5</span>], x[-<span class="hljs-number">1</span>])  <span class="hljs-comment"># 2 5 9</span><br>x[<span class="hljs-number">2</span>: <span class="hljs-number">4</span>]  <span class="hljs-comment"># array([2, 3])</span><br>x[-<span class="hljs-number">3</span>: ]  <span class="hljs-comment"># array([7, 8, 9])</span><br>x[: -<span class="hljs-number">3</span>]  <span class="hljs-comment"># array([0, 1, 2, 3, 4, 5, 6])</span><br></code></pre></td></tr></table></figure><h4 id="二维数组">二维数组</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 二维向量，一般用大写字母</span><br>X = np.arange(<span class="hljs-number">20</span>).reshape(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>],<br>       [ <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>],<br>       [<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>],<br>       [<span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>]])<br><br>X[-<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  <span class="hljs-comment"># 17</span><br><br><span class="hljs-comment"># 可以忽略后续索引值，返回的数是降低一个维度的数组</span><br><span class="hljs-comment"># 这里的2，其实是要筛选第3行</span><br>X[<span class="hljs-number">2</span>]  <span class="hljs-comment"># array([10, 11, 12, 13, 14])</span><br><span class="hljs-comment"># 筛选多行</span><br>X[: -<span class="hljs-number">1</span>]  <span class="hljs-comment"># array([[ 0,  1,  2,  3,  4],</span><br>         <span class="hljs-comment">#       [ 5,  6,  7,  8,  9],</span><br>         <span class="hljs-comment">#       [10, 11, 12, 13, 14]])</span><br>        <br><span class="hljs-comment"># 筛选所有行，然后筛选多列</span><br>X[ : , <span class="hljs-number">2</span>]  <span class="hljs-comment"># array([ 2,  7, 12, 17])</span><br><br><span class="hljs-comment"># me:筛选，比如第2行第3列</span><br>X[<span class="hljs-number">1</span>:<span class="hljs-number">2</span>, <span class="hljs-number">2</span>]  <span class="hljs-comment"># array([7])</span><br></code></pre></td></tr></table></figure><p><strong>注意：切片的修改会修改原来的数组</strong></p><p>原因：Numpy 经常要处理大数组，避免每次都复制</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">x[<span class="hljs-number">2</span>: <span class="hljs-number">4</span>] = <span class="hljs-number">666</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>array([  <span class="hljs-number">0</span>,   <span class="hljs-number">1</span>, <span class="hljs-number">666</span>, <span class="hljs-number">666</span>,   <span class="hljs-number">4</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">6</span>,   <span class="hljs-number">7</span>,   <span class="hljs-number">8</span>,   <span class="hljs-number">9</span>])<br></code></pre></td></tr></table></figure><h3 id="神奇索引">神奇索引</h3><p>其实就是：用整数数组进行的索引，叫神奇索引</p><h4 id="一维数组-1">一维数组</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">x = np.arange(<span class="hljs-number">10</span>)<br>x[[<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>]]  <span class="hljs-comment"># array([3, 4, 7])</span><br><br>indexs = np.array([[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>]])  <span class="hljs-comment"># 相当于换了一种索引方式</span><br>x[indexs]  <span class="hljs-comment"># array([[0, 2],</span><br>           <span class="hljs-comment">#        [1, 3]])</span><br></code></pre></td></tr></table></figure><p>栗子：获取数组中最大的前N个数字</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 随机生成1到100之间的，10个数</span><br>arr = np.random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>, <span class="hljs-number">10</span>)  <span class="hljs-comment"># array([ 6, 97, 1, 80, 73, 31, 16, 26, 46, 22])</span><br><br><span class="hljs-comment"># arr.argsort()会返回排序后的索引index</span><br><span class="hljs-comment"># 取最大值对应的3个下标</span><br>arr.argsort()[-<span class="hljs-number">3</span>:]  <span class="hljs-comment"># array([4, 3, 1], dtype=int64)</span><br><br>arr[arr.argsort()[-<span class="hljs-number">3</span>:]]  <span class="hljs-comment"># array([73, 80, 97])</span><br><br></code></pre></td></tr></table></figure><h4 id="二维数组-1">二维数组</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">X = np.arange(<span class="hljs-number">20</span>).reshape(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>)<br><span class="hljs-comment"># 筛选多行，列可以省略</span><br>X[[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>]]  <span class="hljs-comment"># 相当于 X[[0,2], :]</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>],<br>           [<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>]])<br><br><span class="hljs-comment"># 同时执行行列-列表</span><br><span class="hljs-comment"># 返回的是[(0, 1), (2, 3), (3, 4)]位置的数字</span><br>X[[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]]<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([ <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">19</span>])<br></code></pre></td></tr></table></figure><h3 id="布尔索引">布尔索引</h3><p>注意：布尔索引选择的数据是数组的拷贝</p><h4 id="一维数组-2">一维数组</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">x = np.arange(<span class="hljs-number">10</span>)<br>x &gt; <span class="hljs-number">5</span>  <span class="hljs-comment"># array([False, False, False, False, False, False,  True,  True,  True, True])</span><br>x[x &gt; <span class="hljs-number">5</span>]  <span class="hljs-comment"># array([6, 7, 8, 9])</span><br></code></pre></td></tr></table></figure><h4 id="二维数组-2">二维数组</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">X = np.arange(<span class="hljs-number">20</span>).reshape(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>)<br>X &gt; <span class="hljs-number">5</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[<span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>],<br>           [<span class="hljs-literal">False</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>],<br>           [ <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>],<br>           [ <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>,  <span class="hljs-literal">True</span>]])<br><br><span class="hljs-comment"># X &gt; 5的boolean数组，既有行，又有列</span><br><span class="hljs-comment"># 因此返回的是以（行，列）为结果</span><br>X[X &gt; <span class="hljs-number">5</span>]  <br><span class="hljs-meta">&gt;&gt;&gt; </span>array([ <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>])<br></code></pre></td></tr></table></figure><p>栗子：筛选第三列大于5的行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">X[:, <span class="hljs-number">2</span>]  <span class="hljs-comment"># array([2, 7, 12, 17])</span><br>X[:, <span class="hljs-number">2</span>] &gt; <span class="hljs-number">5</span>  <span class="hljs-comment"># array([False, True, True, True])</span><br><br>X[X[:, <span class="hljs-number">2</span>] &gt; <span class="hljs-number">5</span>]<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[ <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>],<br>           [<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>],<br>           [<span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>]])<br></code></pre></td></tr></table></figure><h3 id="条件的组合">条件的组合</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 注意，每个条件都得加小括号</span><br>condition = (x%<span class="hljs-number">2</span> == <span class="hljs-number">0</span>) | (x &gt; <span class="hljs-number">7</span>)<br>condition <br><span class="hljs-meta">&gt;&gt;&gt; </span>array([ <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">True</span>])<br><br>x[condition]<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>])<br></code></pre></td></tr></table></figure><h2 id="常用-random-随机函数汇总">常用 random 随机函数汇总</h2><p><a target="_blank" rel="noopener" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/routines.random.html">官方文档地址</a></p><p><img src="https://gitee.com/stuxiaozhang/blogimage/raw/master/img/编程语言/Flask/image-20210603112451290.png" srcset="/img/loading.gif" lazyload></p><h3 id="randd0-d1-...-dn">1. rand(d0, d1, ..., dn)</h3><p>返回数据在[0, 1)之间，具有均匀分布</p><p>note：括号里就是数组的 shape 吧</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">np.random.rand(<span class="hljs-number">5</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([<span class="hljs-number">0.6999419</span> , <span class="hljs-number">0.46259045</span>, <span class="hljs-number">0.76988761</span>, <span class="hljs-number">0.70682691</span>, <span class="hljs-number">0.07794833</span>])<br><br>np.random.rand(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[<span class="hljs-number">0.46748888</span>, <span class="hljs-number">0.39767725</span>, <span class="hljs-number">0.53824109</span>, <span class="hljs-number">0.32306072</span>],<br>       	   [<span class="hljs-number">0.32192706</span>, <span class="hljs-number">0.58147814</span>, <span class="hljs-number">0.51342599</span>, <span class="hljs-number">0.51541956</span>],<br>       	   [<span class="hljs-number">0.87084285</span>, <span class="hljs-number">0.32134477</span>, <span class="hljs-number">0.05494504</span>, <span class="hljs-number">0.97090779</span>]])<br></code></pre></td></tr></table></figure><h3 id="randnd0-d1-...-dn">2. randn(d0, d1, ..., dn)</h3><p>返回数据具有标准正态分布（均值0， 方差1）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">np.random.rand(<span class="hljs-number">5</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([-<span class="hljs-number">0.1719413</span> , -<span class="hljs-number">0.40536603</span>, -<span class="hljs-number">1.08071032</span>, -<span class="hljs-number">0.07730974</span>, -<span class="hljs-number">0.90159565</span>])<br><br>np.random.rand(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[ <span class="hljs-number">1.43158401</span>,  <span class="hljs-number">1.2062071</span> ,  <span class="hljs-number">0.3741147</span> , -<span class="hljs-number">0.82679866</span>],<br>       	   [ <span class="hljs-number">0.56348707</span>, -<span class="hljs-number">2.39543479</span>,  <span class="hljs-number">1.0254253</span> ,  <span class="hljs-number">1.35024282</span>],<br>           [-<span class="hljs-number">1.5868889</span> , -<span class="hljs-number">0.44797611</span>,  <span class="hljs-number">1.53968612</span>,  <span class="hljs-number">0.85347238</span>]])<br></code></pre></td></tr></table></figure><h3 id="randintlow-high-size-dtype">3. randint(low[, high, size, dtype])</h3><p>生成随机整数，包含low，不包含high。如果high不指定，则从[0, low)中生成数字</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">np.random.randint(<span class="hljs-number">3</span>)  <span class="hljs-comment"># 0, 1, 2中随机抽一个</span><br>np.random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>)  <span class="hljs-comment"># 1~9 随机抽一个</span><br>np.random.randint(<span class="hljs-number">10</span>, <span class="hljs-number">30</span>, size=(<span class="hljs-number">5</span>,))  <span class="hljs-comment"># array([28, 10, 12, 29, 19])</span><br>np.random.randint(<span class="hljs-number">10</span>, <span class="hljs-number">30</span>, size=(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>))<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[[<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">27</span>, <span class="hljs-number">11</span>],<br>            [<span class="hljs-number">11</span>, <span class="hljs-number">11</span>, <span class="hljs-number">21</span>, <span class="hljs-number">29</span>],<br>            [<span class="hljs-number">29</span>, <span class="hljs-number">26</span>, <span class="hljs-number">24</span>, <span class="hljs-number">27</span>]],<br><br>           [[<span class="hljs-number">14</span>, <span class="hljs-number">13</span>, <span class="hljs-number">24</span>, <span class="hljs-number">16</span>],<br>            [<span class="hljs-number">14</span>, <span class="hljs-number">17</span>, <span class="hljs-number">23</span>, <span class="hljs-number">10</span>],<br>            [<span class="hljs-number">20</span>, <span class="hljs-number">27</span>, <span class="hljs-number">19</span>, <span class="hljs-number">22</span>]]])<br></code></pre></td></tr></table></figure><h3 id="randomsize">4. random([size])</h3><p>生成 [0.0, 1.0) 的随机数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">np.random.random(<span class="hljs-number">5</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([<span class="hljs-number">0.87659215</span>, <span class="hljs-number">0.48806388</span>, <span class="hljs-number">0.31897873</span>, <span class="hljs-number">0.28465993</span>, <span class="hljs-number">0.4402444</span> ])<br><br>np.random.random(size=(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>))<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[<span class="hljs-number">0.95544107</span>, <span class="hljs-number">0.10927452</span>, <span class="hljs-number">0.33025455</span>, <span class="hljs-number">0.43884905</span>],<br>       	   [<span class="hljs-number">0.51232723</span>, <span class="hljs-number">0.96086108</span>, <span class="hljs-number">0.85268131</span>, <span class="hljs-number">0.80582844</span>],<br>           [<span class="hljs-number">0.36631864</span>, <span class="hljs-number">0.05322777</span>, <span class="hljs-number">0.27671375</span>, <span class="hljs-number">0.06613997</span>]])<br></code></pre></td></tr></table></figure><h3 id="choicea-size-replace-p">5. choice(a[, size, replace, p])</h3><p>a是一维数组，从它里面生成随机结果</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 这时候，a是数字，则从range(5)中生成，size为3</span><br>np.random.choice(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>)  <span class="hljs-comment"># array([2, 1, 4])</span><br>np.random.choice(<span class="hljs-number">5</span>, (<span class="hljs-number">2</span>, <span class="hljs-number">3</span>))  <span class="hljs-comment"># array([[4, 1, 2], [2, 4, 0]])</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 这时候，a是数组，从里面随机取出数字</span><br>np.random.choice([<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>], <span class="hljs-number">3</span>)  <span class="hljs-comment"># array([2, 3, 4])</span><br>np.random.choice([<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>], (<span class="hljs-number">2</span>, <span class="hljs-number">3</span>))  <span class="hljs-comment"># array([[4, 3, 4], [5, 6, 4]])</span><br></code></pre></td></tr></table></figure><h3 id="shufflex">6. shuffle(x)</h3><p>把一个数组x进行随机排列</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">a = np.arange(<span class="hljs-number">10</span>)<br>np.random.shuffle(a)  <span class="hljs-comment"># array([2, 0, 3, 6, 1, 4, 5, 8, 9, 7])</span><br></code></pre></td></tr></table></figure><p><strong>注：如果数组是多维的，则只会在第一维度打散数据</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">a = np.arange(<span class="hljs-number">20</span>).reshape(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>)<br>np.random.shuffle(a)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>],<br>       	   [ <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>],<br>           [ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>],<br>           [<span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>]])<br></code></pre></td></tr></table></figure><h3 id="permutationx">7. permutation(x)</h3><p>把一个数组x进行随机排列，或者数字的全排列</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 这时，生成range(10)的随机排列</span><br>np.random.permutation(<span class="hljs-number">10</span>)<br><br><span class="hljs-comment"># 其实相当于</span><br>a = np.arange(<span class="hljs-number">10</span>)<br>np.random.shuffle(a)<br><br><span class="hljs-meta">&gt;&gt;&gt; </span>array([<span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">9</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">arr = np.arange(<span class="hljs-number">9</span>).reshape((<span class="hljs-number">3</span>, <span class="hljs-number">3</span>))<br><span class="hljs-comment"># 这时，在第一维度进行打散</span><br>np.random.permutation(arr)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[<span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>],<br>           [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>],<br>           [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]])<br></code></pre></td></tr></table></figure><p><strong>注：这里不会更改原来的arr，会返回一个新的copy</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">arr<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>],<br>           [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>],<br>           [<span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>]])<br></code></pre></td></tr></table></figure><h3 id="normalloc-scale-size">8. normal([loc, scale, size])</h3><p>按照平均值loc和方差scale生成高斯分布的数字</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">np.random.normal(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([  <span class="hljs-number">3.96767152</span>,  <span class="hljs-number">11.20604462</span>, -<span class="hljs-number">10.66355692</span>,   <span class="hljs-number">3.28964678</span>,<br>         <span class="hljs-number">2.5968747</span> ,   <span class="hljs-number">3.09770873</span>,   <span class="hljs-number">2.40696033</span>,  -<span class="hljs-number">2.93361133</span>,<br>        <span class="hljs-number">16.12715299</span>,  -<span class="hljs-number">5.51975866</span>])<br><br>np.random.normal(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">4</span>))<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[  <span class="hljs-number">0.59465584</span>, -<span class="hljs-number">12.56034849</span>, -<span class="hljs-number">17.21235221</span>,   <span class="hljs-number">5.86058884</span>],<br>       	   [  <span class="hljs-number">8.95106662</span>,  -<span class="hljs-number">4.17923506</span>, -<span class="hljs-number">11.10878236</span>,  -<span class="hljs-number">6.65145514</span>],<br>           [  <span class="hljs-number">0.17354117</span>, -<span class="hljs-number">13.12031261</span>,  -<span class="hljs-number">9.3815636</span> ,  <span class="hljs-number">12.08462607</span>]])<br></code></pre></td></tr></table></figure><h3 id="uniformlow-high-size">9. uniform([low, high, size])</h3><p>在[low, high)之间生成均匀分布的数字</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">np.random.uniform(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([<span class="hljs-number">8.94300171</span>, <span class="hljs-number">5.94501361</span>, <span class="hljs-number">9.16434763</span>, <span class="hljs-number">3.45496344</span>, <span class="hljs-number">1.74573521</span>,<br>       <span class="hljs-number">2.15601979</span>, <span class="hljs-number">2.85097589</span>, <span class="hljs-number">9.02594814</span>, <span class="hljs-number">9.38130143</span>, <span class="hljs-number">7.95087103</span>])<br><br>np.random.uniform(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">4</span>))<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[<span class="hljs-number">1.87292668</span>, <span class="hljs-number">2.16985327</span>, <span class="hljs-number">5.02085781</span>, <span class="hljs-number">1.72454695</span>],<br>           [<span class="hljs-number">8.87026442</span>, <span class="hljs-number">8.82115077</span>, <span class="hljs-number">6.47268473</span>, <span class="hljs-number">6.11754421</span>],<br>           [<span class="hljs-number">4.23536288</span>, <span class="hljs-number">8.02647045</span>, <span class="hljs-number">9.87668833</span>, <span class="hljs-number">4.10706247</span>]])<br></code></pre></td></tr></table></figure><p>栗子：对数组加入随机噪声</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 绘制sin曲线</span><br>x = np.linspace(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">100</span>)  <span class="hljs-comment"># -10到10平均生成100个点(点加的)</span><br>y = np.sin(x)<br>plt.plot(x, y)<br>plt.show()<br></code></pre></td></tr></table></figure><figure><img src="https://gitee.com/stuxiaozhang/blogimage/raw/master/img/编程语言/Flask/image-20210603115427686.png" srcset="/img/loading.gif" lazyload alt="image-20210603115427686"><figcaption>image-20210603115427686</figcaption></figure><p>加入噪声</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">x = np.linspace(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">100</span>)<br>y = np.sin(x) + np.random.rand(<span class="hljs-built_in">len</span>(x))  <span class="hljs-comment"># 生成随机数的维度和x的维度相同</span><br>plt.plot(x, y)<br>plt.show()<br></code></pre></td></tr></table></figure><figure><img src="C:%5CUsers%5CHP%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210603115521197.png" srcset="/img/loading.gif" lazyload alt="image-20210603115521197"><figcaption>image-20210603115521197</figcaption></figure><h2 id="numpy-的数字统计函数">Numpy 的数字统计函数</h2><h3 id="常用的数学统计函数">1. 常用的数学统计函数</h3><table><thead><tr class="header"><th>函数名</th><th>说明</th></tr></thead><tbody><tr class="odd"><td>np.sum</td><td>所有元素的和</td></tr><tr class="even"><td>np.prod</td><td>所有元素的乘积</td></tr><tr class="odd"><td>np.cumsum</td><td>元素的累积加和 cumulative sum</td></tr><tr class="even"><td>np.cumprod</td><td>所有元素的累积乘积</td></tr><tr class="odd"><td>np.min</td><td>最小值</td></tr><tr class="even"><td>np.max</td><td>最大值</td></tr><tr class="odd"><td>np.percentile</td><td>0-100百分位数</td></tr><tr class="even"><td>np.quantile</td><td>0-1分位数</td></tr><tr class="odd"><td>np.median</td><td>中位数</td></tr><tr class="even"><td>np.average</td><td>加权平均，参数可以指定weights</td></tr><tr class="odd"><td>np.mean</td><td>平均值</td></tr><tr class="even"><td>np.std</td><td>标准差</td></tr><tr class="odd"><td>np.var</td><td>方差</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">arr = np.arange(<span class="hljs-number">12</span>).reshape(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)  <span class="hljs-comment"># 没有指定轴，numpy会把数组当成一维数组</span><br><br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],<br>       [ <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>],<br>       [ <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>]])<br><br>np.<span class="hljs-built_in">sum</span>(arr)  <span class="hljs-comment"># 66</span><br>np.prod(arr)  <span class="hljs-comment"># 0</span><br>np.cumsum(arr)  <span class="hljs-comment"># 累加  array([ 0,  1,  3,  6, 10, 15, 21, 28, 36, 45, 55, 66], dtype=int32)</span><br>np.cumprod(arr) <span class="hljs-comment"># 累积  array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], dtype=int32)</span><br>print(np.<span class="hljs-built_in">min</span>(arr), np.<span class="hljs-built_in">max</span>(arr))  <span class="hljs-comment"># 0 11</span><br><br>np.percentile(arr, [<span class="hljs-number">25</span>, <span class="hljs-number">50</span>, <span class="hljs-number">75</span>]) <span class="hljs-comment"># 等同于下面</span><br>np.quantile(arr, [<span class="hljs-number">0.25</span>, <span class="hljs-number">0.50</span>, <span class="hljs-number">0.75</span>]) <span class="hljs-comment"># 有小数是因为偶数个的话没有中间数，会把两个数加和平均</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>array([<span class="hljs-number">2.75</span>, <span class="hljs-number">5.5</span> , <span class="hljs-number">8.25</span>])<br><br>print(np.median(arr), np.mean(arr))  <span class="hljs-comment"># 5.5 5.5</span><br>print(np.std(arr), np.var(arr))  <span class="hljs-comment"># 3.452052529534663 11.916666666666666</span><br><br><span class="hljs-comment"># 加权平均</span><br><span class="hljs-comment"># weights的shape需要和arr一样</span><br>weights = np.random.rand(*arr.shape)  <br>np.average(arr, weights=weights)  <span class="hljs-comment"># 5.225244488519801</span><br></code></pre></td></tr></table></figure><h3 id="numpy-的-axis-参数的用途">2. Numpy 的 axis 参数的用途</h3><p><strong>axis=0 代表行，axis=1 代表列</strong></p><p>对于 sum/mean/media 等<strong>聚合函数</strong>：</p><ul><li>理解：<strong>axis=0 代表把行消解掉，axis=1 代表把列消解掉</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">arr = np.arange(<span class="hljs-number">12</span>).reshape(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)<br><br>arr.<span class="hljs-built_in">sum</span>(axis=<span class="hljs-number">0</span>)  <span class="hljs-comment"># array([12, 15, 18, 21])</span><br>arr.<span class="hljs-built_in">sum</span>(axis=<span class="hljs-number">1</span>)  <span class="hljs-comment"># array([ 6, 22, 38])</span><br><br>arr.cumsum(axis=<span class="hljs-number">0</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],<br>       	   [ <span class="hljs-number">4</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">10</span>],<br>           [<span class="hljs-number">12</span>, <span class="hljs-number">15</span>, <span class="hljs-number">18</span>, <span class="hljs-number">21</span>]], dtype=int32)<br>arr.cumsum(axis=<span class="hljs-number">1</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">6</span>],<br>           [ <span class="hljs-number">4</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">15</span>, <span class="hljs-number">22</span>],<br>           [ <span class="hljs-number">8</span>, <span class="hljs-number">17</span>, <span class="hljs-number">27</span>, <span class="hljs-number">38</span>]], dtype=int32)<br></code></pre></td></tr></table></figure><p>栗子：将机器学习数据进行标准化</p><p>arr 如果对应到现实世界的一种解释：</p><ul><li>行：每一行对应一个样本数据</li><li>列：每一列代表样本的一个特征</li></ul><p>数据标准化：</p><ul><li>对于机器学习、神经网络来说，不同列的量纲应该相同，训练收敛的更快；</li><li>比如商品的价格是0到100元、销量是1万到10万个，这俩数字没有可比性，因此需要先都做标准化；</li><li>标准化一般使用 <span class="math inline">\(A = \frac{A - mean(A, axis=0)}{std(A, axis=0)}\)</span> 公式进行</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">arr = np.random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>, size=(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>))<br><br><span class="hljs-comment"># 计算每列的均值</span><br>mean = np.mean(arr, axis=<span class="hljs-number">0</span>)<br><span class="hljs-comment"># 计算每列的标准差</span><br>std = np.std(arr, axis=<span class="hljs-number">0</span>)<br><span class="hljs-comment"># 计算分子，注意每行都会分别减去对应列的均值，这叫做numpy的广播</span><br>fenzi = arr - mean<br><br>result = fenzi / std<br></code></pre></td></tr></table></figure><h2 id="numpy-计算数组中满足条件的元素个数">Numpy 计算数组中满足条件的元素个数</h2><p>需求：有一个非常大的数组比如1亿数字，求出里面数字小于5000的数字数目</p><p>注：该栗子验证了numpy的计算速度比py快</p><p>使用 numpy 的 random 模块生成1亿个数字</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">arr = np.random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">10000</span>, size=<span class="hljs-built_in">int</span>(<span class="hljs-number">1e8</span>))<br>arr.size  <span class="hljs-comment"># 100000000</span><br></code></pre></td></tr></table></figure><ol type="1"><li>使用 python 原生语法实现</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">py_arr = <span class="hljs-built_in">list</span>(arr)<br><span class="hljs-comment"># 记一下时间</span><br>%timeit <span class="hljs-built_in">len</span>([x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> py_arr <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">5000</span>])<br>&gt;&gt; <span class="hljs-number">23.6</span> s ± <span class="hljs-number">4.62</span> s per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>使用 numpy 的向量化操作实现</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 记一下时间</span><br>%timeit arr[arr &gt; <span class="hljs-number">5000</span>].size<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">844</span> ms ± <span class="hljs-number">49.1</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)<br></code></pre></td></tr></table></figure><p>对比时间</p><p>23.6 * 1000 / 844 = 27.96，快了近28倍左右</p><h2 id="numpy-给数组增加维度">Numpy 给数组增加维度</h2><p><strong>背景：</strong> 很多数据计算都是二维或三维的，对于一维的数据输入为了形状匹配，经常需要升维变成二维</p><p><strong>需要：</strong> 在不改变数据的情况下，添加数组为度：（注意观察这个栗子，维度变了，但是<strong>数据没变</strong>） 原始数组：一维数组 arr=[1, 2, 3, 4]，其shape是 (4,)，取值分别为 arr[0]，arr[1]，arr[2]，arr[3] 变形数组：二维数组 arr=[[1, 2, 3, 4]]，其shape是 (1, 4)，取值分别为 arr[0, 0]，arr[0, 1]，arr[0, 2]，arr[0, 3]</p><p><strong>实操：</strong> 经常需要在纸上手绘数组的形状，来查看不同数组是否形状匹配，是否需要升降维</p><p><strong>3种方法：</strong></p><ul><li><code>np.newaxis</code>：关键字，使用索引的语法给数组添加维度</li><li><code>np.expand_dims(arr, axis)</code>：方法，和<code>np.newaxis</code>实现一样的功能，给arr在axis为位置添加维度</li><li><code>np.reshape(a, newshape)</code>：方法，给一个维度设置为1完成升维</li></ul><h3 id="np.newaxis-关键字">1. np.newaxis 关键字</h3><p><strong>注意：<code>np.newaxis</code>其实就是None的别名</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">np.newaxis <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>  <span class="hljs-comment"># True</span><br>np.newaxis == <span class="hljs-literal">None</span>  <span class="hljs-comment"># True</span><br></code></pre></td></tr></table></figure><p>即以下所有的<code>np.newaxis</code>的位置，都可以用None替代</p><h4 id="给一维向量添加一个行维度">给一维向量添加一个行维度</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">arr[np.newaxis, :]  <span class="hljs-comment"># array([[0, 1, 2, 3, 4]])</span><br>arr[np.newaxis, :].shape  <span class="hljs-comment"># (1, 5)</span><br></code></pre></td></tr></table></figure><p>数据现在是一行*五列，数据本身没有增减，只是多了一级括号</p><h4 id="给一维向量添加一个列维度">给一维向量添加一个列维度</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">arr[:, np.newaxis]<br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[<span class="hljs-number">0</span>],<br>           [<span class="hljs-number">1</span>],<br>           [<span class="hljs-number">2</span>],<br>           [<span class="hljs-number">3</span>],<br>           [<span class="hljs-number">4</span>]])<br>arr[:, np.newaxis].shape  <span class="hljs-comment"># (5, 1)</span><br></code></pre></td></tr></table></figure><p>数据现在是五行*一列</p><h3 id="np.expand_dims-方法">2. np.expand_dims 方法</h3><p><code>np.expand_dims</code>方法实现的效果，和 <code>np.newaxis</code> 关键字是一模一样的</p><h4 id="给一维向量添加一个行维度-1">给一维向量添加一个行维度</h4><p>相当于 <code>arr[np.newaxis, :]</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">np.expand_dims(arr, axis=<span class="hljs-number">0</span>)  <span class="hljs-comment"># 0代表行 array([[0, 1, 2, 3, 4]])</span><br>np.expand_dims(arr, axis=<span class="hljs-number">0</span>).shape  <span class="hljs-comment"># (1, 5)</span><br></code></pre></td></tr></table></figure><h4 id="给一维向量添加一个列维度-1">给一维向量添加一个列维度</h4><p>相当于 <code>arr[:, np.newaxis]</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">np.expand_dims(arr, axis=<span class="hljs-number">1</span>)  <span class="hljs-comment"># 1代表列 array([[0], [1], [2], [3], [4]]) </span><br>np.expand_dims(arr, axis=<span class="hljs-number">1</span>).shape  <span class="hljs-comment"># (5, 1)</span><br></code></pre></td></tr></table></figure><h3 id="np.reshape-方法">3. np.reshape 方法</h3><h4 id="给一维向量添加一个行维度-2">给一维向量添加一个行维度</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">np.reshape(arr, (<span class="hljs-number">1</span>, <span class="hljs-number">5</span>))  <span class="hljs-comment"># array([[0, 1, 2, 3, 4]])</span><br>np.reshape(arr, (<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>))  <span class="hljs-comment"># array([[0, 1, 2, 3, 4]])</span><br></code></pre></td></tr></table></figure><h4 id="给一维向量添加一个列维度-2">给一维向量添加一个列维度</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">np.reshape(arr, (-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>))  <span class="hljs-comment"># array([[0], [1], [2], [3], [4]])</span><br>np.reshape(arr, (-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)).shape  <span class="hljs-comment"># (5, 1)</span><br></code></pre></td></tr></table></figure><h2 id="numpy-数组合并">Numpy 数组合并</h2><p>背景：在给及学习准备数据的过程中，需要经常进行不同来源的数据合并的操作 两类场景：</p><ol type="1"><li>给已有的数据添加多行，比如添加一些样本数据进去；</li><li>给已有的数据添加多列，比如添加一些样本特征进去；</li></ol><p>以下操作均可以实现数组合并：</p><ul><li><code>np.concatenate(array_list, axis=0/1)</code>：沿着指定axis进行数组的合并</li><li><code>np.vstack</code> 或者 <code>np.row_stack(array_list)</code>：垂直地vertically、按行row wise进行数据合并</li><li><code>np.hstack</code> 或者 <code>np.column_stack(array_list)</code>：水平地horizontally、按列column wise进行数据合并</li></ul><h3 id="给数据添加新的多行">1. 给数据添加新的多行</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python">a = np.arange(<span class="hljs-number">6</span>).reshape(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)<br>b = np.random.randint(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, size=(<span class="hljs-number">4</span>, <span class="hljs-number">3</span>))<br><span class="hljs-meta">&gt;&gt;&gt; </span>a: [[<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span>]<br> 		[<span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span>]]<br>b: [[<span class="hljs-number">15</span> <span class="hljs-number">19</span> <span class="hljs-number">19</span>]<br> 	[<span class="hljs-number">13</span> <span class="hljs-number">10</span> <span class="hljs-number">17</span>]<br> 	[<span class="hljs-number">19</span> <span class="hljs-number">13</span> <span class="hljs-number">17</span>]<br> 	[<span class="hljs-number">16</span> <span class="hljs-number">15</span> <span class="hljs-number">14</span>]]<br><br><span class="hljs-comment"># 方法1：</span><br>np.concatenate([a, b])<br><span class="hljs-comment"># 方法2(垂直地按行合并)</span><br>np.vstack([a, b])<br><span class="hljs-comment"># 方法3</span><br>np.row_stack([a, b])<br><br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>],<br>           [ <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>],<br>           [<span class="hljs-number">15</span>, <span class="hljs-number">19</span>, <span class="hljs-number">19</span>],<br>           [<span class="hljs-number">13</span>, <span class="hljs-number">10</span>, <span class="hljs-number">17</span>],<br>           [<span class="hljs-number">19</span>, <span class="hljs-number">13</span>, <span class="hljs-number">17</span>],<br>           [<span class="hljs-number">16</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>]])<br></code></pre></td></tr></table></figure><h3 id="给数据添加新的多列">2. 给数据添加新的多列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">a = np.arange(<span class="hljs-number">6</span>).reshape(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>)<br>b = np.random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>, size=(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>))<br><br>np.concatenate([a, b], axis=<span class="hljs-number">1</span>)<br><span class="hljs-comment"># 水平地 按列合并</span><br>np.hstack([a, b])<br>np.column_stack([a, b])<br><br><span class="hljs-meta">&gt;&gt;&gt; </span>array([[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>],<br>       	   [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>],<br>           [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>]])<br></code></pre></td></tr></table></figure></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/tags/Python/">Python</a> <a class="hover-with-bg" href="/tags/Numpy/">Numpy</a></div></div><p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处来源：<a href="https://stuxiaozhang.github.io/">小张的宇宙空间站</a></p><div class="post-prevnext"><article class="post-prev col-6"><a href="/2021/06/06/%E6%9D%8E%E5%AE%8F%E6%AF%85%20%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%BB%8B%E7%BB%8D/"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">李宏毅 机器学习介绍</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2021/04/06/SQLAlchemy%E5%85%A5%E9%97%A8/"><span class="hidden-mobile">SQLAlchemy入门</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments" lazyload><div id="valine"></div><script type="text/javascript">Fluid.utils.loadComments("#valine",function(){Fluid.utils.createScript("https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js",function(){var e=Object.assign({appId:"81O1jSOqY3veRxOg71BDYfri-gzGzoHsz",appKey:"CgnvRL262D07ied40NiXm2VL",placeholder:"快来评论鸭~",path:"window.location.pathname",avatar:"retro",meta:["nick","mail","link"],pageSize:10,lang:"zh-CN",highlight:!0,recordIP:!0,serverURLs:"",emojiCDN:"https://cdn.bootcdn.net/ajax/libs/emojione/4.5.0/lib/js/emojione.min.js",emojiMaps:null,enableQQ:!0,requiredFields:["nick"]},{el:"#valine",path:window.location.pathname});new Valine(e)})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"><a href="https://stuxiaozhang.github.io" target="_blank" rel="nofollow noopener"><span>小张同学的宇宙空间站</span></a> 已经运转了<span id="timeDate">载入天数...</span><script src="/js/duration.js"></script></div><div class="statistics"><span id="leancloud-site-pv-container" style="display:none">总访问量 <span id="leancloud-site-pv"></span> 次 </span><span id="leancloud-site-uv-container" style="display:none">总访客数 <span id="leancloud-site-uv"></span> 人</span></div></footer><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script><script src="/js/local-search.js"></script><script defer src="/js/leancloud.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js"></script><script>!function(t){(0,Fluid.plugins.typing)(t.getElementById("subtitle").title)}((window,document))</script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},options:{renderActions:{findScript:[10,a=>{document.querySelectorAll('script[type^="math/tex"]').forEach(e=>{var t=!!e.type.match(/; *mode=display/);const n=new a.options.MathItem(e.textContent,a.inputJax[0],t);t=document.createTextNode("");e.parentNode.replaceChild(t,e),n.start={node:t,delim:"",n:0},n.end={node:t,delim:"",n:0},a.math.push(n)})},"",!1],insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(e=>{let t=e.parentNode;"li"===t.nodeName.toLowerCase()&&t.parentNode.classList.add("has-jax")})},"",!1]}}}</script><script async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.4/es5/tex-svg.js"></script><script src="/js/boot.js"></script></body></html>